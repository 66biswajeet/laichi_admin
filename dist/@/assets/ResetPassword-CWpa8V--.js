import{h as N,s as v,q as k,r as l,o as S,j as s,f as d,i as E}from"./index-DjdYpa2W.js";import{u as C,E as w}from"./index.esm-r8MUZnl_.js";import{L as h}from"./LabelArea-3SiEI5lF.js";import{A as L}from"./AdminServices-UtE7rAlO.js";import{n as R,a as A}from"./toast-DjDqlBK5.js";import{I,a as T}from"./forgot-password-office-dark-CQOqfqw9.js";const V=()=>{const{t:e}=N(),{token:p}=v();k();const[o,i]=l.useState(!1),[q,x]=l.useState(0),{register:c,handleSubmit:g,watch:b,formState:{errors:m,isValid:j}}=C({mode:"onChange"}),n=l.useRef("");n.current=b("newPassword","");const u=l.useCallback(a=>{let t=0;return a.length>=10&&(t+=1),/[A-Z]/.test(a)&&(t+=1),/[a-z]/.test(a)&&(t+=1),/[0-9]/.test(a)&&(t+=1),/[^A-Za-z0-9]/.test(a)&&(t+=1),t},[]);S.useEffect(()=>{n.current&&x(u(n.current))},[n.current,u]);const y=async({newPassword:a})=>{var t,f;if(!o){i(!0);try{const r=await L.resetPassword({newPassword:a,token:p});R(r.message),setTimeout(()=>history.push("/login"),2e3)}catch(r){A(((f=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:f.message)||r.message||"Reset failed")}finally{i(!1)}}},P={required:e("You must specify a password")||"You must specify a password",minLength:{value:10,message:e("Password must have at least 10 characters")||"Password must have at least 10 characters"},validate:{hasUpperCase:a=>/[A-Z]/.test(a)||e("Password must contain at least one uppercase letter")||"Password must contain at least one uppercase letter",hasLowerCase:a=>/[a-z]/.test(a)||e("Password must contain at least one lowercase letter")||"Password must contain at least one lowercase letter",hasNumber:a=>/[0-9]/.test(a)||e("Password must contain at least one number")||"Password must contain at least one number"}};return s.jsx("div",{className:"flex items-center min-h-screen p-6 bg-gray-50 dark:bg-gray-900",children:s.jsx("div",{className:"flex-1 h-full max-w-4xl mx-auto overflow-hidden bg-white rounded-lg shadow-xl dark:bg-gray-800",children:s.jsxs("div",{className:"flex flex-col overflow-y-auto md:flex-row",children:[s.jsxs("div",{className:"h-32 md:h-auto md:w-1/2",children:[s.jsx("img",{"aria-hidden":"true",className:"object-cover w-full h-full dark:hidden",src:I,alt:"Office"}),s.jsx("img",{"aria-hidden":"true",className:"hidden object-cover w-full h-full dark:block",src:T,alt:"Office"})]}),s.jsx("main",{className:"flex items-center justify-center p-6 sm:p-12 md:w-1/2",children:s.jsxs("div",{className:"w-full",children:[s.jsx("h1",{className:"mb-4 text-xl font-semibold text-gray-700 dark:text-gray-200",children:e("ResetPassword")}),s.jsx("p",{className:"mb-6 text-sm text-gray-600 dark:text-gray-400",children:e("Enter your new password below")}),s.jsxs("form",{onSubmit:g(y),children:[s.jsx(h,{label:e("New Password")}),s.jsx(d.Input,{name:"newPassword",type:"password",autoComplete:"new-password",placeholder:e("Enter new password"),...c("newPassword",P),className:"mt-1",disabled:o}),s.jsx(w,{errorName:m.newPassword}),s.jsxs("div",{className:"mt-6",children:[s.jsx(h,{label:e("Confirm Password")}),s.jsx(d.Input,{name:"confirm_password",type:"password",autoComplete:"new-password",placeholder:e("Confirm your password"),...c("confirm_password",{required:e("Please confirm your password")||"Please confirm your password",validate:a=>a===n.current||e("The passwords do not match")||"The passwords do not match"}),className:"mt-1",disabled:o}),s.jsx(w,{errorName:m.confirm_password})]}),s.jsx(d.Button,{disabled:o||!j,type:"submit",block:!0,className:"mt-6 h-12",children:e(o?"Resetting...":"Reset Password")})]}),s.jsx("p",{className:"mt-4 text-center",children:s.jsx(E,{className:"text-sm font-medium text-emerald-500 dark:text-emerald-400 hover:underline focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 rounded",to:"/login",children:e("Back to Login")})})]})})]})})})};export{V as default};
