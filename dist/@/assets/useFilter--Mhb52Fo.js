import{A as $e,c as Ge}from"./browser-DDvgk3Ro.js";import{d as E,u as He}from"./Layout-CC_gf8s-.js";import{c as fe,g as ge,r as o,u as Xe,S as ke,L as Ke}from"./index-DjdYpa2W.js";import{u as Qe}from"./useDisableForDemo-C6HHjxCb.js";import{P as We,C as et,A as tt}from"./ProductServices-CJRh4QM3.js";import{C as st,a as nt}from"./CouponServices-Bq0cN76W.js";import{C as ot}from"./CurrencyServices-SLwyUqNy.js";import{a as p,n as O}from"./toast-DjDqlBK5.js";var Se={exports:{}};(function(h,x){(function(P,C){h.exports=C()})(fe,function(){return function(P,C,b){C.prototype.isBetween=function(j,T,g,w){var R=b(j),m=b(T),U=(w=w||"()")[0]==="(",F=w[1]===")";return(U?this.isAfter(R,g):!this.isBefore(R,g))&&(F?this.isBefore(m,g):!this.isAfter(m,g))||(U?this.isBefore(R,g):!this.isAfter(R,g))&&(F?this.isAfter(m,g):!this.isBefore(m,g))}}})})(Se);var at=Se.exports;const rt=ge(at);var ye={exports:{}};(function(h,x){(function(P,C){h.exports=C()})(fe,function(){return function(P,C,b){C.prototype.isToday=function(){var j="YYYY-MM-DD",T=b();return this.format(j)===T.format(j)}}})})(ye);var it=ye.exports;const ut=ge(it),dt={type:"object",properties:{_id:{type:"string"},name:{type:"object"},description:{type:"object"},icon:{type:"string"},status:{type:"string"}},required:["name"]},lt={type:"object",properties:{status:{type:"string"},title:{type:"object"},name:{type:"object"},variants:{type:"array"},option:{type:"string"},type:{type:"string"}},required:["name","title"]},ct={type:"object",properties:{title:{type:"object"},couponCode:{type:"string"},endTime:{type:"string"},discountPercentage:{type:"number"},minimumAmount:{type:"number"},productType:{type:"string"},logo:{type:"string"},discountType:{type:"object"},status:{type:"string"}},required:["title","couponCode","endTime","status"]},pt={type:"object",properties:{name:{type:"string"},email:{type:"string"}},required:["name","email"]},Jt=h=>{const x=new $e({allErrors:!0}),[P,C]=o.useState(""),[b,j]=o.useState(""),[T,g]=o.useState(""),[w,R]=o.useState(""),[m,U]=o.useState(""),[F,Ce]=o.useState(""),[S,W]=o.useState(""),[L,ee]=o.useState(""),[J,te]=o.useState(""),[we,he]=o.useState(""),[M,be]=o.useState(""),[z,Le]=o.useState(""),[De,Ae]=o.useState([]),[Pe,Te]=o.useState([]),[Re,Oe]=o.useState([]),[Z,xe]=o.useState(""),[$,je]=o.useState(""),[I,Fe]=o.useState(""),[G,Ne]=o.useState(1),[_e,se]=o.useState([]),[Be,Ue]=o.useState(""),[Je,Me]=o.useState(""),[Ee,Ie]=o.useState(""),[y,H]=o.useState([]),[ve,v]=o.useState(""),[Ve,V]=o.useState(!1),[X,qe]=o.useState(""),[k]=o.useState([]),ne=o.useRef(""),oe=o.useRef(""),ae=o.useRef(""),re=o.useRef(""),ie=o.useRef(""),K=o.useRef(""),ue=o.useRef(""),de=o.useRef(""),le=o.useRef(""),Ye=o.useRef(""),ce=o.useRef("");E.extend(rt),E.extend(ut);const l=Xe(),{lang:N,setIsUpdate:_,setLoading:f}=o.useContext(ke),{globalSetting:B}=He(),{handleDisableForDemo:Q}=Qe(),D=o.useMemo(()=>{const a=new Date;a.setDate(a.getDate()-I);let t=h==null?void 0:h.map(e=>{const i=new Date(e==null?void 0:e.updatedAt).toLocaleString("en-US",{timeZone:B==null?void 0:B.default_time_zone});return{...e,updatedDate:i==="Invalid Date"?"":i}});if(l.pathname==="/dashboard"){const e=t==null?void 0:t.filter(d=>d.status==="Pending");Ae(e);const i=t==null?void 0:t.filter(d=>d.status==="Processing");Te(i);const s=t==null?void 0:t.filter(d=>d.status==="Delivered");Oe(s);const u=t==null?void 0:t.filter(d=>E(d.createdAt).isToday()),c=u==null?void 0:u.reduce((d,A)=>d+A.total,0);Ue(c);const n=t==null?void 0:t.filter(d=>E(d.createdAt).isBetween(new Date().setDate(new Date().getDate()-30),new Date)),r=n==null?void 0:n.reduce((d,A)=>d+A.total,0);Me(r);const Y=t==null?void 0:t.reduce((d,A)=>d+A.total,0);Ie(Y)}return P&&(t=t.filter(e=>e.parent===P)),b==="Low"&&(t=t.sort((e,i)=>e.price<i.price&&-1)),b==="High"&&(t=t.sort((e,i)=>e.price>i.price&&-1)),T&&(t=t.filter(e=>{var i;return(i=e==null?void 0:e.title)==null?void 0:i.toLowerCase().includes(T.toLowerCase())})),L&&(t=t.filter(e=>{var i,s,u;return((s=(i=e==null?void 0:e.title[N])==null?void 0:i.toLowerCase())==null?void 0:s.includes(L==null?void 0:L.toLowerCase()))||((u=e==null?void 0:e.attribute)==null?void 0:u.toLowerCase().includes(L==null?void 0:L.toLowerCase()))})),S&&(t=t.filter(e=>{var u,c,n,r,Y;const i=((n=(c=(u=e==null?void 0:e.name)==null?void 0:u[N])==null?void 0:c.toLowerCase())==null?void 0:n.includes(S==null?void 0:S.toLowerCase()))||((r=e==null?void 0:e.category)==null?void 0:r.toLowerCase().includes(S==null?void 0:S.toLowerCase())),s=(Y=e==null?void 0:e.children)==null?void 0:Y.some(d=>{var A,pe,me;return(me=(pe=(A=d==null?void 0:d.name)==null?void 0:A[N])==null?void 0:pe.toLowerCase())==null?void 0:me.includes(S==null?void 0:S.toLowerCase())});return i||s})),$&&(t=t.filter(e=>e.role===$)),w&&(t=t.filter(e=>{var i,s,u;return((i=e==null?void 0:e.name[N])==null?void 0:i.toLowerCase().includes(w.toLowerCase()))||((s=e==null?void 0:e.phone)==null?void 0:s.toLowerCase().includes(w.toLowerCase()))||((u=e==null?void 0:e.email)==null?void 0:u.toLowerCase().includes(w.toLowerCase()))})),m&&(t=t==null?void 0:t.filter(e=>{var i,s,u;return((s=(i=e==null?void 0:e.title[N])==null?void 0:i.toLowerCase())==null?void 0:s.includes(m==null?void 0:m.toLowerCase()))||((u=e==null?void 0:e.couponCode)==null?void 0:u.toLowerCase().includes(m==null?void 0:m.toLowerCase()))})),Z&&(t=t.filter(e=>e.status===Z)),F&&(t=t.filter(e=>e.contact.toLowerCase().includes(F.toLowerCase()))),I&&(t=t.filter(e=>E(e.createdAt).isBetween(a,new Date))),J&&(t=t.filter(e=>{var i,s;return((i=e==null?void 0:e.name)==null?void 0:i.toLowerCase().includes(J.toLowerCase()))||((s=e==null?void 0:e.iso_code)==null?void 0:s.toLowerCase().includes(J.toLowerCase()))})),X&&(t=t.filter(e=>e==null?void 0:e.name.toLowerCase().includes(X.toLowerCase()))),M&&(t=t.filter(e=>e.name.toLowerCase().includes(M.toLowerCase())||e.iso_code.toLowerCase().includes(M.toLowerCase())||e.language_code.toLowerCase().includes(M.toLowerCase()))),z&&(t=t.filter(e=>e.iso_code.toLowerCase().includes(z.toLowerCase()))),t},[I,h,l.pathname,P,b,T,L,S,$,w,m,Z,F,J,X,M,z,K,B==null?void 0:B.default_time_zone,N]),q=20,ze=D==null?void 0:D.length,Ze=a=>{Ne(a)};return o.useEffect(()=>{se(D==null?void 0:D.slice((G-1)*q,G*q))},[D,G,q]),{userRef:ae,searchRef:oe,couponRef:re,orderRef:ie,categoryRef:K,attributeRef:ue,pending:De,processing:Pe,delivered:Re,todayOrder:Be,monthlyOrder:Je,totalOrder:Ee,setFilter:C,setSortedField:j,setStatus:xe,setRole:je,time:I,zone:we,setTime:Fe,taxRef:Ye,setZone:he,filename:ve,countryRef:de,dataTable:_e,serviceData:D,country:J,setSearchText:g,setCountry:te,isDisabled:Ve,languageRef:le,currencyRef:ne,shippingRef:ce,setSearchUser:R,setDataTable:se,setCategoryType:W,handleChangePage:Ze,totalResults:ze,resultsPerPage:q,handleOnDrop:a=>{for(let t=0;t<a.length;t++)k.push(a[t].data)},setSearchCoupon:U,setAttributeTitle:ee,handleSelectFile:a=>{var i;if(a.preventDefault(),Q())return;const t=new FileReader,e=(i=a.target)==null?void 0:i.files[0];e&&e.type==="application/json"?(v(e==null?void 0:e.name),V(!0),console.log("if"),t.readAsText(e,"UTF-8"),t.onload=s=>{let u=JSON.parse(s.target.result),c=[];l.pathname==="/categories"&&(c=u.map(n=>({_id:n._id,id:n.id,status:n.status,name:n.name,description:n.description,parentName:n.parentName,parentId:n.parentId,icon:n.icon}))),l.pathname==="/attributes"&&(c=u.map(n=>({_id:n._id,status:n.status,title:n.title,name:n.name,variants:n.variants,option:n.option,type:n.type}))),l.pathname==="/coupons"&&(c=u.map(n=>({title:n.title,couponCode:n.couponCode,endTime:n.endTime,discountPercentage:n.discountPercentage,minimumAmount:n.minimumAmount,productType:n.productType,logo:n.logo,discountType:n.discountType,status:n.status}))),l.pathname==="/customers"&&(c=u.map(n=>({name:n.name,email:n.email,password:n.password,phone:n.phone}))),H(c)}):e&&e.type==="text/csv"?(v(e==null?void 0:e.name),V(!0),console.log("else if"),t.onload=async s=>{const u=s.target.result,c=await Ge().fromString(u);let n=[];l.pathname==="/categories"&&(n=c.map(r=>({_id:r._id,id:r.id,status:r.status,name:JSON.parse(r.name),description:JSON.parse(r.description),parentName:r.parentName,parentId:r.parentId,icon:r.icon}))),l.pathname==="/attributes"&&(n=c.map(r=>({status:r.status,title:JSON.parse(r.title),name:JSON.parse(r.name),variants:JSON.parse(r.variants),option:r.option,type:r.type}))),l.pathname==="/coupons"&&(n=c.map(r=>({title:JSON.parse(r.title),couponCode:r.couponCode,endTime:r.endTime,discountPercentage:r.discountPercentage?JSON.parse(r.discountPercentage):0,minimumAmount:r.minimumAmount?JSON.parse(r.minimumAmount):0,productType:r.productType,logo:r.logo,status:r.status}))),l.pathname==="/customers"&&(n=c.map(r=>({name:r.name,email:r.email,password:r.password,phone:r.phone}))),H(n)},t.readAsText(e)):(v(e==null?void 0:e.name),V(!0),p("Unsupported file type!"))},handleSubmitUser:a=>{a.preventDefault(),R(ae.current.value)},handleSubmitForAll:a=>{a.preventDefault(),g(oe.current.value)},handleSubmitCoupon:a=>{a.preventDefault(),U(re.current.value)},handleSubmitOrder:a=>{a.preventDefault(),Ce(ie.current.value)},handleSubmitCategory:a=>{a.preventDefault(),W(K.current.value)},handleSubmitAttribute:a=>{a.preventDefault(),ee(ue.current.value)},handleUploadProducts:()=>{if(k.length<1)p("Please upload/select csv file first!");else{if(Q())return;We.addAllProducts(k).then(a=>{O(a.message)}).catch(a=>p(a.message))}},handleSubmitCountry:a=>{a.preventDefault(),te(de.current.value)},handleSubmitCurrency:a=>{a.preventDefault(),Le(ne.current.value)},handleSubmitShipping:a=>{a.preventDefault(),qe(ce.current.value)},handleSubmitLanguage:a=>{a.preventDefault(),be(le.current.value)},handleUploadMultiple:a=>{if(!Q())if(y.length>1){if(l.pathname==="/categories"){f(!0);let t=y.map(s=>x.validate(dt,s));const e=s=>s===!0;t.every(e)?st.addAllCategory(y).then(s=>{f(!1),_(!0),O(s.message)}).catch(s=>{f(!1),p(s?s.response.data.message:s.message)}):p("Please enter valid data!")}if(l.pathname==="/customers"){f(!0);let t=y.map(s=>x.validate(pt,s));const e=s=>s===!0;t.every(e)?et.addAllCustomers(y).then(s=>{f(!1),_(!0),O(s.message)}).catch(s=>{f(!1),p(s?s.response.data.message:s.message)}):p("Please enter valid data!")}if(l.pathname==="/coupons"){f(!0);let t=y.map(s=>x.validate(ct,s));const e=s=>s===!0;t.every(e)?nt.addAllCoupon(y).then(s=>{f(!1),_(!0),O(s.message)}).catch(s=>{f(!1),p(s?s.response.data.message:s.message)}):p("Please enter valid data!")}if(l.pathname==="/attributes"){f(!0);let t=y.map(s=>x.validate(lt,s));const e=s=>s===!0;t.every(e)?tt.addAllAttributes(y).then(s=>{f(!1),_(!0),O(s.message)}).catch(s=>{f(!1),p(s?s.response.data.message:s.message)}):p("Please enter valid data!")}l.pathname==="/languages"&&Ke.addAllLanguage(y).then(t=>{_(!0),O(t.message)}).catch(t=>p(t?t.response.data.message:t.message)),l.pathname==="/currencies"&&ot.addAllCurrency(y).then(t=>{_(!0),O(t.message)}).catch(t=>p(t?t.response.data.message:t.message))}else p("Please select a valid .JSON/.CSV/.XLS file first!")},handleRemoveSelectFile:a=>{v(""),H([]),setTimeout(()=>V(!1),1e3)}}};export{ut as a,rt as i,Jt as u};
