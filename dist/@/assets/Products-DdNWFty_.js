import{r as y,j as e,f as t,i as K,t as Q,S as I,h as J}from"./index-DjdYpa2W.js";import{u as R,g as W,h as X,i as Y,b as ee,c as se,e as le}from"./Layout-CC_gf8s-.js";import{u as _}from"./useAsync-ZUR2i2Lf.js";import{u as E}from"./DrawerButton-BVAP5kMS.js";import{U as te}from"./UploadMany-BsHjyB1S.js";import{N as ae}from"./NotFound-B98lRYvl.js";import{P as B}from"./ProductServices-CJRh4QM3.js";import{P as re}from"./PageTitle-H6vnBSo9.js";import{M}from"./MainDrawer-C792pCvG.js";import{P as L}from"./ProductDrawer-BjwZrHz9.js";import{C as z}from"./CheckBox-46nNUpuw.js";import{D as H}from"./DeleteModal-cFnm5AMi.js";import{E as ie}from"./EditDeleteButton-DP-eF8Sj.js";import{S as ne,B as oe}from"./BulkActionDrawer-LUetHFDC.js";import{T as de}from"./Tooltip-kLpuPd-Y.js";import{A as ce,c as xe}from"./browser-DDvgk3Ro.js";import{a as P,n as O}from"./toast-DjDqlBK5.js";import{u as me}from"./useDisableForDemo-C6HHjxCb.js";import{T as ge}from"./TableLoading-u8ybCk9T.js";import{C as he}from"./CouponServices-Bq0cN76W.js";import{A as be}from"./AnimatedContent-Dramat6q.js";import"./iconBase-TplbiNF9.js";import"./logo-color-CF1h2kui.js";import"./spinner-CkndCogW.js";import"./exportFromJSON-fDIoOtpr.js";import"./ParentCategory-C6Rko6G4.js";import"./index-GA0pI32j.js";import"./index.esm-r8MUZnl_.js";import"./InputArea-BaXQNw-P.js";import"./LabelArea-3SiEI5lF.js";import"./InputValue-DSWFRran.js";import"./sweetalert.min-CJsXi30a.js";import"./useTranslationValue-Cw-m3XH1.js";import"./Uploader-m7hlwNE2.js";import"./tslib.es6-BfZZHrVl.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index--JtT38Uf.js";import"./index.prod-DOlhr_XB.js";import"./AdminServices-UtE7rAlO.js";import"./CurrencyServices-SLwyUqNy.js";import"./SwitchToggle-BlzZU-78.js";const pe=({products:j,isCheck:n,setIsCheck:b})=>{const{title:T,serviceId:m,handleModalOpen:i,handleUpdate:v}=E(),{currency:w,showingTranslateValue:f,getNumberTwo:u}=R(),[N,S]=y.useState({}),D=s=>{const{id:g,checked:p}=s.target;b([...n,g]),p||b(n.filter(l=>l!==g))},k=s=>{S(g=>({...g,[s]:!g[s]}))},F=s=>{if(!(s!=null&&s.isCombination)||!(s!=null&&s.variants)||s.variants.length===0)return e.jsx("span",{className:"text-xs text-gray-400",children:"No variants"});const g=s.variants.filter(l=>l&&l.variantType==="size"),p=N[s._id];return g.length===0?e.jsxs("span",{className:"text-xs text-gray-600",children:[s.variants.length," variant(s)"]}):e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>k(s._id),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800 rounded transition-colors",children:[e.jsxs("span",{children:[g.length," Size Variant",g.length>1?"s":""]}),p?e.jsx(X,{className:"w-3 h-3"}):e.jsx(Y,{className:"w-3 h-3"})]}),p&&e.jsx("div",{className:"absolute z-50 mt-1 w-64 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 max-h-80 overflow-y-auto",children:e.jsx("div",{className:"p-2 space-y-2",children:g.map((l,c)=>e.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 rounded border border-blue-200 dark:border-blue-700",children:[e.jsx("div",{className:"font-semibold text-xs text-blue-800 dark:text-blue-200 mb-1",children:l==null?void 0:l.combination}),(l==null?void 0:l.pricingTiers)&&l.pricingTiers.length>0&&e.jsx("div",{className:"space-y-1",children:l.pricingTiers.map((r,a)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-white dark:bg-gray-800 px-2 py-1 rounded",children:[e.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[r.quantity," pcs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.discount>0&&e.jsxs("span",{className:"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-1.5 py-0.5 rounded text-xs font-semibold",children:[r.discount,"% off"]}),e.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:[w," ",r.finalPrice.toFixed(2)]})]})]},a))})]},c))})})]})};return e.jsxs(e.Fragment,{children:[(n==null?void 0:n.length)<1&&e.jsx(H,{id:m,title:T}),(n==null?void 0:n.length)<2&&e.jsx(M,{children:e.jsx(L,{currency:w,id:m})}),e.jsx(t.TableBody,{children:j==null?void 0:j.map((s,g)=>{var p,l,c,r;return e.jsxs(t.TableRow,{children:[e.jsx(t.TableCell,{children:e.jsx(z,{type:"checkbox",name:(p=s==null?void 0:s.title)==null?void 0:p.en,id:s._id,handleClick:D,isChecked:n==null?void 0:n.includes(s._id)})}),e.jsx(t.TableCell,{children:e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.image[0]?e.jsx(t.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:s==null?void 0:s.image[0],alt:"product"}):e.jsx(t.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx("div",{children:(()=>{const a=f(s==null?void 0:s.title)||"";return e.jsx("h2",{className:`text-sm font-medium ${a.length>30?"wrap-long-title":""}`,children:a.substring(0,28)})})()})]})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm",children:f((l=s==null?void 0:s.category)==null?void 0:l.name)})}),e.jsx(t.TableCell,{children:F(s)}),e.jsx(t.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[w," ",s!=null&&s.isCombination?(()=>{var o,h;const a=s==null?void 0:s.variants[0];return(a==null?void 0:a.variantType)==="size"&&((o=a==null?void 0:a.pricingTiers)==null?void 0:o.length)>0?u((h=s==null?void 0:s.prices)==null?void 0:h.originalPrice):u(a==null?void 0:a.originalPrice)})():u((c=s==null?void 0:s.prices)==null?void 0:c.originalPrice)]})}),e.jsx(t.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[w," ",s!=null&&s.isCombination?(()=>{var o,h;const a=s==null?void 0:s.variants[0];return(a==null?void 0:a.variantType)==="size"&&((o=a==null?void 0:a.pricingTiers)==null?void 0:o.length)>0?u((h=s==null?void 0:s.prices)==null?void 0:h.price):u(a==null?void 0:a.price)})():u((r=s==null?void 0:s.prices)==null?void 0:r.price)]})}),e.jsx(t.TableCell,{children:e.jsx(K,{to:`/product/${s._id}`,className:"flex justify-center text-gray-400 hover:text-emerald-600",children:e.jsx(de,{id:"view",Icon:W,title:Q("DetailsTbl"),bgColor:"#10B981"})})}),e.jsx(t.TableCell,{className:"text-center",children:e.jsx(ne,{id:s._id,status:s.status})}),e.jsx(t.TableCell,{children:e.jsx(ie,{id:s._id,product:s,isCheck:n,handleUpdate:v,handleModalOpen:i,title:f(s==null?void 0:s.title)})})]},g+1)})})]})},je={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},fe=j=>{const n=new ce({allErrors:!0}),{setLoading:b,setIsUpdate:T}=y.useContext(I),[m]=y.useState([]),[i,v]=y.useState([]),[w,f]=y.useState(""),[u,N]=y.useState(!1),{handleDisableForDemo:S}=me();return{data:j,filename:w,isDisabled:u,handleSelectFile:async l=>{var a;l.preventDefault();const c=new FileReader,r=(a=l.target)==null?void 0:a.files[0];r&&r.type==="application/json"?(f(r==null?void 0:r.name),N(!0),c.readAsText(r,"UTF-8"),c.onload=o=>{const C=JSON.parse(o.target.result).map(d=>({categories:d.categories,image:d.image,barcode:d.barcode,tag:d.tag,variants:d.variants,status:d.status,prices:d.prices,isCombination:JSON.parse(d.isCombination.toLowerCase()),title:d.title,productId:d.productId,slug:d.slug,sku:d.sku,category:d.category,stock:d.stock,description:d.description}));v(C)}):r&&r.type==="text/csv"?(f(r==null?void 0:r.name),N(!0),c.onload=async o=>{const h=o.target.result,d=(await xe().fromString(h)).map(x=>({categories:JSON.parse(x.categories),image:JSON.parse(x.image),barcode:x.barcode,tag:JSON.parse(x.tag),variants:JSON.parse(x.variants),status:x.status,prices:JSON.parse(x.prices),isCombination:JSON.parse(x.isCombination.toLowerCase()),title:JSON.parse(x.title),productId:x.productId,slug:x.slug,sku:x.sku,category:JSON.parse(x.category),stock:JSON.parse(x.stock),description:JSON.parse(x.description)}));v(d)},c.readAsText(r)):(f(r==null?void 0:r.name),N(!0),P("Unsupported file type!"))},serviceData:j,handleOnDrop:l=>{for(let c=0;c<l.length;c++)m.push(l[c].data)},handleUploadProducts:()=>{if(!S())if(m.length<1)P("Please upload/select csv file first!");else{if(S())return;B.addAllProducts(m).then(l=>{O(l.message)}).catch(l=>P(l.message))}},handleRemoveSelectFile:l=>{f(""),v([]),setTimeout(()=>N(!1),1e3)},handleUploadMultiple:l=>{if(!S())if(i.length>1){b(!0);let c=i.map(o=>n.validate(je,o));const r=o=>o===!0;c.every(r)?B.addAllProducts(i).then(o=>{T(!0),b(!1),O(o.message)}).catch(o=>{b(!1),P(o.message)}):(b(!1),P("Please enter valid data!"))}else b(!1),P("Please select a valid json, csv & xls file first!")}}},ue=({setCategory:j})=>{const{t:n}=J(),{data:b}=_(he.getAllCategories),{showingTranslateValue:T}=R();return e.jsx(e.Fragment,{children:e.jsxs(t.Select,{onChange:m=>j(m.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:n("Category")}),b==null?void 0:b.map(m=>e.jsx("option",{value:m._id,children:T(m==null?void 0:m.name)},m._id))]})})},ns=()=>{const{title:j,allId:n,serviceId:b,handleDeleteMany:T,handleUpdateMany:m}=E(),{t:i}=J(),{toggleDrawer:v,lang:w,currentPage:f,handleChangePage:u,searchText:N,category:S,setCategory:D,searchRef:k,handleSubmitForAll:F,sortedField:s,setSortedField:g,limitData:p}=y.useContext(I),{data:l,loading:c,error:r}=_(()=>B.getAllProducts({page:f,limit:p,category:S,title:N,price:s})),[a,o]=y.useState(!1),[h,C]=y.useState([]),d=()=>{o(!a),C(l==null?void 0:l.products.map(U=>U._id)),a&&C([])},x=()=>{D(""),g(""),k.current.value=""},{serviceData:A,filename:q,isDisabled:V,handleSelectFile:$,handleUploadMultiple:Z,handleRemoveSelectFile:G}=fe(l==null?void 0:l.products);return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:i("ProductsPage")}),e.jsx(H,{ids:n,setIsCheck:C,title:j}),e.jsx(oe,{ids:n,title:"Products"}),e.jsx(M,{children:e.jsx(L,{id:b})}),e.jsxs(be,{children:[e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 mb-5",children:e.jsx(t.CardBody,{className:"",children:e.jsxs("form",{onSubmit:F,className:"py-3 md:pb-0 grid gap-4 lg:gap-6 xl:gap-6 xl:flex",children:[e.jsx("div",{className:"flex-grow-0 sm:flex-grow md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(te,{title:"Products",filename:q,isDisabled:V,totalDoc:l==null?void 0:l.totalDoc,handleSelectFile:$,handleUploadMultiple:Z,handleRemoveSelectFile:G})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{disabled:h.length<1,onClick:()=>m(h),className:"w-full rounded-md h-12 btn-gray text-gray-600",children:[e.jsx("span",{className:"mr-2",children:e.jsx(ee,{})}),i("BulkAction")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{disabled:(h==null?void 0:h.length)<1,onClick:()=>T(h,l.products),className:"w-full rounded-md h-12 bg-red-300 disabled btn-red",children:[e.jsx("span",{className:"mr-2",children:e.jsx(se,{})}),i("Delete")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{onClick:v,className:"w-full rounded-md h-12",children:[e.jsx("span",{className:"mr-2",children:e.jsx(le,{})}),i("AddProduct")]})})]})]})})}),e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(t.CardBody,{children:e.jsxs("form",{onSubmit:F,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(t.Input,{ref:k,type:"search",name:"search",placeholder:"Search Product"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(ue,{setCategory:D,lang:w})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Select,{onChange:U=>g(U.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:i("Price")}),e.jsx("option",{value:"low",children:i("LowtoHigh")}),e.jsx("option",{value:"high",children:i("HightoLow")}),e.jsx("option",{value:"published",children:i("Published")}),e.jsx("option",{value:"unPublished",children:i("Unpublished")}),e.jsx("option",{value:"status-selling",children:i("StatusSelling")}),e.jsx("option",{value:"status-out-of-stock",children:i("StatusStock")}),e.jsx("option",{value:"date-added-asc",children:i("DateAddedAsc")}),e.jsx("option",{value:"date-added-desc",children:i("DateAddedDesc")}),e.jsx("option",{value:"date-updated-asc",children:i("DateUpdatedAsc")}),e.jsx("option",{value:"date-updated-desc",children:i("DateUpdatedDesc")})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{type:"submit",className:"h-12 w-full bg-blue-500 hover:bg-blue-600 rounded-lg shadow-sm hover:shadow-md",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{layout:"outline",onClick:x,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-slate-700 bg-slate-100 border-slate-300 dark:border-slate-600",children:e.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:"Reset"})})})]})]})})})]}),c?e.jsx(ge,{row:12,col:7,width:160,height:20}):r?e.jsx("span",{className:"text-center mx-auto text-red-500",children:r}):(A==null?void 0:A.length)!==0?e.jsxs(t.TableContainer,{className:"mb-8 rounded-b-lg",children:[e.jsxs(t.Table,{children:[e.jsx(t.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(t.TableCell,{children:e.jsx(z,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:a,handleClick:d})}),e.jsx(t.TableCell,{children:i("ProductNameTbl")}),e.jsx(t.TableCell,{children:i("CategoryTbl")}),e.jsx(t.TableCell,{children:"Variants Detail"}),e.jsx(t.TableCell,{children:i("PriceTbl")}),e.jsx(t.TableCell,{children:"Sale Price"}),e.jsx(t.TableCell,{className:"text-center",children:i("DetailsTbl")}),e.jsx(t.TableCell,{className:"text-center",children:i("PublishedTbl")}),e.jsx(t.TableCell,{className:"text-right",children:i("ActionsTbl")})]})}),e.jsx(pe,{lang:w,isCheck:h,products:l==null?void 0:l.products,setIsCheck:C})]}),e.jsx(t.TableFooter,{children:e.jsx(t.Pagination,{totalResults:l==null?void 0:l.totalDoc,resultsPerPage:p,onChange:u,label:"Product Page Navigation"})})]}):e.jsx(ae,{title:"Product"})]})};export{ns as default};
