import{g as Yt,o as re,r as c,v as Gt,c as gt,u as Xt,S as Zt,j as e,f as u,h as ot,i as Wt}from"./index-DjdYpa2W.js";import{P as es,M as ts,R as ss}from"./ParentCategory-C6Rko6G4.js";import{u as _e,e as et,q as Ue,r as rs,b as as,c as Me,s as xt,t as lt,l as ls}from"./Layout-CC_gf8s-.js";import{j as it}from"./index-GA0pI32j.js";import{T as pt,D as rt}from"./DrawerButton-BVAP5kMS.js";import{u as ns,E as Ie}from"./index.esm-r8MUZnl_.js";import{I as ht}from"./InputArea-BaXQNw-P.js";import{L as be}from"./LabelArea-3SiEI5lF.js";import{I as ft}from"./InputValue-DSWFRran.js";import{s as bt}from"./sweetalert.min-CJsXi30a.js";import{u as os}from"./useAsync-ZUR2i2Lf.js";import{A as is,P as at}from"./ProductServices-CJRh4QM3.js";import{a as ee,n as me}from"./toast-DjDqlBK5.js";import{u as cs}from"./useTranslationValue-Cw-m3XH1.js";import{U as kt}from"./Uploader-m7hlwNE2.js";import{T as yt}from"./Tooltip-kLpuPd-Y.js";import{a as ds}from"./index.prod-DOlhr_XB.js";var wt={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var s={}.hasOwnProperty;function r(){for(var a=[],n=0;n<arguments.length;n++){var d=arguments[n];if(d){var l=typeof d;if(l==="string"||l==="number")a.push(d);else if(Array.isArray(d)){if(d.length){var j=r.apply(null,d);j&&a.push(j)}}else if(l==="object"){if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]")){a.push(d.toString());continue}for(var w in d)s.call(d,w)&&d[w]&&a.push(w)}}}return a.join(" ")}t.exports?(r.default=r,t.exports=r):window.classNames=r})()})(wt);var us=wt.exports;const $e=Yt(us);function ms(t){if(Array.isArray(t)){for(var s=0,r=Array(t.length);s<t.length;s++)r[s]=t[s];return r}else return Array.from(t)}var ct=!1;if(typeof window<"u"){var jt={get passive(){ct=!0}};window.addEventListener("testPassive",null,jt),window.removeEventListener("testPassive",null,jt)}var Ct=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),Te=[],Ge=!1,St=-1,ze=void 0,Le=void 0,Tt=function(s){return Te.some(function(r){return!!(r.options.allowTouchMove&&r.options.allowTouchMove(s))})},Xe=function(s){var r=s||window.event;return Tt(r.target)||r.touches.length>1?!0:(r.preventDefault&&r.preventDefault(),!1)},gs=function(s){if(Le===void 0){var r=!!s&&s.reserveScrollBarGap===!0,a=window.innerWidth-document.documentElement.clientWidth;r&&a>0&&(Le=document.body.style.paddingRight,document.body.style.paddingRight=a+"px")}ze===void 0&&(ze=document.body.style.overflow,document.body.style.overflow="hidden")},xs=function(){Le!==void 0&&(document.body.style.paddingRight=Le,Le=void 0),ze!==void 0&&(document.body.style.overflow=ze,ze=void 0)},ps=function(s){return s?s.scrollHeight-s.scrollTop<=s.clientHeight:!1},hs=function(s,r){var a=s.targetTouches[0].clientY-St;return Tt(s.target)?!1:r&&r.scrollTop===0&&a>0||ps(r)&&a<0?Xe(s):(s.stopPropagation(),!0)},fs=function(s,r){if(!s){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!Te.some(function(n){return n.targetElement===s})){var a={targetElement:s,options:r||{}};Te=[].concat(ms(Te),[a]),Ct?(s.ontouchstart=function(n){n.targetTouches.length===1&&(St=n.targetTouches[0].clientY)},s.ontouchmove=function(n){n.targetTouches.length===1&&hs(n,s)},Ge||(document.addEventListener("touchmove",Xe,ct?{passive:!1}:void 0),Ge=!0)):gs(r)}},bs=function(s){if(!s){console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");return}Te=Te.filter(function(r){return r.targetElement!==s}),Ct?(s.ontouchstart=null,s.ontouchmove=null,Ge&&Te.length===0&&(document.removeEventListener("touchmove",Xe,ct?{passive:!1}:void 0),Ge=!1)):Te.length||xs()};function ys(t=null){let[s,r]=re.useState(t);const{current:a}=re.useRef({current:s});return Object.defineProperty(a,"current",{get:()=>s,set:n=>{Object.is(s,n)||(s=n,r(n))}}),a}function js(t,s={isStateful:!0}){const r=ys(null),a=c.useRef(null),n=s.isStateful?r:a;return re.useEffect(()=>{!t||(typeof t=="function"?t(n.current):t.current=n.current)}),n}function Ze(){return Ze=Object.assign||function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Ze.apply(this,arguments)}var vs=function(s){var r=s.classes,a=s.classNames,n=s.styles,d=s.id,l=s.closeIcon,j=s.onClick;return re.createElement("button",{id:d,className:$e(r.closeButton,a==null?void 0:a.closeButton),style:n==null?void 0:n.closeButton,onClick:j,"data-testid":"close-button"},l||re.createElement("svg",{className:a==null?void 0:a.closeIcon,style:n==null?void 0:n.closeIcon,width:28,height:28,viewBox:"0 0 36 36","data-testid":"close-icon"},re.createElement("path",{d:"M28.5 9.62L26.38 7.5 18 15.88 9.62 7.5 7.5 9.62 15.88 18 7.5 26.38l2.12 2.12L18 20.12l8.38 8.38 2.12-2.12L20.12 18z"})))},Ye=typeof window<"u",Pt=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'];function Ns(t){return t.offsetParent===null||getComputedStyle(t).visibility==="hidden"}function ks(t,s){for(var r=0;r<t.length;r++)if(t[r].checked&&t[r].form===s)return t[r]}function ws(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!0;var s=t.form||t.ownerDocument,r=s.querySelectorAll('input[type="radio"][name="'+t.name+'"]'),a=ks(r,t.form);return a===t||a===void 0&&r[0]===t}function At(t){for(var s=document.activeElement,r=t.querySelectorAll(Pt.join(",")),a=[],n=0;n<r.length;n++){var d=r[n];(s===d||!d.disabled&&Ss(d)>-1&&!Ns(d)&&ws(d))&&a.push(d)}return a}function Cs(t,s){if(!(!t||t.key!=="Tab")){if(!s||!s.contains)return process,!1;if(!s.contains(t.target))return!1;var r=At(s),a=r[0],n=r[r.length-1];return t.shiftKey&&t.target===a?(n.focus(),t.preventDefault(),!0):!t.shiftKey&&t.target===n?(a.focus(),t.preventDefault(),!0):!1}}function Ss(t){var s=parseInt(t.getAttribute("tabindex"),10);return isNaN(s)?Ts(t)?0:t.tabIndex:s}function Ts(t){return t.getAttribute("contentEditable")}var Ps=function(s){var r=s.container,a=s.initialFocusRef,n=c.useRef();return c.useEffect(function(){var d=function(C){r!=null&&r.current&&Cs(C,r.current)};if(Ye&&document.addEventListener("keydown",d),Ye&&(r!=null&&r.current)){var l=function(){Pt.findIndex(function(C){var T;return(T=document.activeElement)==null?void 0:T.matches(C)})!==-1&&(n.current=document.activeElement)};if(a)l(),requestAnimationFrame(function(){var w;(w=a.current)==null||w.focus()});else{var j=At(r.current);j[0]&&(l(),j[0].focus())}}return function(){if(Ye){var w;document.removeEventListener("keydown",d),(w=n.current)==null||w.focus()}}},[r,a]),null},Oe=[],nt={add:function(s){Oe.push(s)},remove:function(s){Oe=Oe.filter(function(r){return r!==s})},isTopModal:function(s){return!!Oe.length&&Oe[Oe.length-1]===s}};function As(t,s){c.useEffect(function(){return s&&nt.add(t),function(){nt.remove(t)}},[s,t])}var Es=function(s,r,a,n,d){var l=c.useRef(null);c.useEffect(function(){return r&&s.current&&n&&(l.current=s.current,fs(s.current,{reserveScrollBarGap:d})),function(){l.current&&(bs(l.current),l.current=null)}},[r,a,s,n,d])},ke={root:"react-responsive-modal-root",overlay:"react-responsive-modal-overlay",overlayAnimationIn:"react-responsive-modal-overlay-in",overlayAnimationOut:"react-responsive-modal-overlay-out",modalContainer:"react-responsive-modal-container",modalContainerCenter:"react-responsive-modal-containerCenter",modal:"react-responsive-modal-modal",modalAnimationIn:"react-responsive-modal-modal-in",modalAnimationOut:"react-responsive-modal-modal-out",closeButton:"react-responsive-modal-closeButton"},Is=re.forwardRef(function(t,s){var r,a,n,d,l=t.open,j=t.center,w=t.blockScroll,C=w===void 0?!0:w,T=t.closeOnEsc,K=T===void 0?!0:T,M=t.closeOnOverlayClick,H=M===void 0?!0:M,B=t.container,i=t.showCloseIcon,m=i===void 0?!0:i,o=t.closeIconId,y=t.closeIcon,N=t.focusTrapped,O=N===void 0?!0:N,te=t.initialFocusRef,ae=te===void 0?void 0:te,X=t.animationDuration,E=X===void 0?300:X,k=t.classNames,h=t.styles,R=t.role,$=R===void 0?"dialog":R,ge=t.ariaDescribedby,le=t.ariaLabelledby,ye=t.containerId,he=t.modalId,oe=t.onClose,de=t.onEscKeyDown,Q=t.onOverlayClick,je=t.onAnimationEnd,x=t.children,f=t.reserveScrollBarGap,D=js(s),Y=c.useRef(null),S=c.useRef(null),A=c.useRef(null);A.current===null&&Ye&&(A.current=document.createElement("div"));var z=c.useState(!1),J=z[0],se=z[1];As(Y,l),Es(Y,l,J,C,f);var ie=function(){A.current&&!B&&!document.body.contains(A.current)&&document.body.appendChild(A.current),document.addEventListener("keydown",De)},Be=function(){A.current&&!B&&document.body.contains(A.current)&&document.body.removeChild(A.current),document.removeEventListener("keydown",De)},De=function(L){L.keyCode!==27||!nt.isTopModal(Y)||(de==null||de(L),K&&oe())};c.useEffect(function(){return function(){J&&Be()}},[J]),c.useEffect(function(){l&&!J&&(se(!0),ie())},[l]);var Ke=function(L){if(S.current===null&&(S.current=!0),!S.current){S.current=null;return}Q==null||Q(L),H&&oe(),S.current=null},xe=function(){S.current=!1},Ve=function(){l||se(!1),je==null||je()},ve=B||A.current,Ce=l?(r=k==null?void 0:k.overlayAnimationIn)!=null?r:ke.overlayAnimationIn:(a=k==null?void 0:k.overlayAnimationOut)!=null?a:ke.overlayAnimationOut,Se=l?(n=k==null?void 0:k.modalAnimationIn)!=null?n:ke.modalAnimationIn:(d=k==null?void 0:k.modalAnimationOut)!=null?d:ke.modalAnimationOut;return J&&ve?Gt.createPortal(re.createElement("div",{className:$e(ke.root,k==null?void 0:k.root),style:h==null?void 0:h.root,"data-testid":"root"},re.createElement("div",{className:$e(ke.overlay,k==null?void 0:k.overlay),"data-testid":"overlay","aria-hidden":!0,style:Ze({animation:Ce+" "+E+"ms"},h==null?void 0:h.overlay)}),re.createElement("div",{ref:Y,id:ye,className:$e(ke.modalContainer,j&&ke.modalContainerCenter,k==null?void 0:k.modalContainer),style:h==null?void 0:h.modalContainer,"data-testid":"modal-container",onClick:Ke},re.createElement("div",{ref:D,className:$e(ke.modal,k==null?void 0:k.modal),style:Ze({animation:Se+" "+E+"ms"},h==null?void 0:h.modal),onMouseDown:xe,onMouseUp:xe,onClick:xe,onAnimationEnd:Ve,id:he,role:$,"aria-modal":"true","aria-labelledby":le,"aria-describedby":ge,"data-testid":"modal",tabIndex:-1},O&&re.createElement(Ps,{container:D,initialFocusRef:ae}),x,m&&re.createElement(vs,{classes:ke,classNames:k,styles:h,closeIcon:y,onClick:oe,id:o})))),ve):null}),Et={},We=gt&&gt.__assign||function(){return We=Object.assign||function(t){for(var s,r=1,a=arguments.length;r<a;r++){s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},We.apply(this,arguments)};Object.defineProperty(Et,"__esModule",{value:!0});function Fs(t){var s,r=[];for(var a in t){for(var n=t[a],d=[],l=0;l<n.length;l++)for(var j=0;j<(r.length||1);j++){var w=We(We({},r[j]),(s={},s[a]=n[l],s));d.push(w)}r=d}return r}var Os=Et.default=Fs;const Bs=t=>{const s=Xt(),{isDrawerOpen:r,closeDrawer:a,setIsUpdate:n,lang:d}=c.useContext(Zt),{data:l}=os(is.getShowingAttributes),j=c.useRef([]),w=c.useRef(""),[C,T]=c.useState([]),[K,M]=c.useState([]),[H,B]=c.useState({});let[i,m]=c.useState([]);const[o,y]=c.useState([]),[N,O]=c.useState(0),[te,ae]=c.useState(0),[X,E]=c.useState(0),[k,h]=c.useState(0),[R,$]=c.useState(""),[ge,le]=c.useState(""),[ye,he]=c.useState(!1),[oe,de]=c.useState("Basic Info"),[Q,je]=c.useState(!1),[x,f]=c.useState([]),[D,Y]=c.useState([]),[S,A]=c.useState([]),[z,J]=c.useState(""),[se,ie]=c.useState(t),[Be,De]=c.useState(""),[Ke,xe]=c.useState(!1),[Ve,ve]=c.useState([]),[Ce,Se]=c.useState([]),[Z,L]=c.useState({}),[_,b]=c.useState("en"),[fe,ne]=c.useState(!1),[It,Ne]=c.useState(!1),[Ft,tt]=c.useState(""),[ue,qe]=c.useState([]),[Ot,dt]=c.useState(!1),{handlerTextTranslateHandler:ut}=cs(),{showingTranslateValue:Pe,getNumber:mt,getNumberTwo:Ae}=_e(),Bt=()=>ne(!1),{register:Dt,handleSubmit:Vt,setValue:P,clearErrors:we,formState:{errors:qt}}=ns(),Rt=async g=>{var I,V,q,U;try{if(Ne(!0),!C)return ee("Image is required!");if(g.originalPrice<g.price)return Ne(!1),ee("Sale Price must be less then or equal of product price!");if(!Ce[0])return Ne(!1),ee("Default Category is required!");if(Q&&i.length===0&&ue.length===0)return Ne(!1),ee("Please add at least one variant or disable combination!");const F=i.map((v,W)=>({...v,price:Ae(v==null?void 0:v.price),originalPrice:Ae(v==null?void 0:v.originalPrice),discount:Ae(v==null?void 0:v.discount),quantity:Number((v==null?void 0:v.quantity)||0)})),ce=ue.map((v,W)=>({...v,variantType:"size",quantity:Number((v==null?void 0:v.quantity)||0)})),G=ue.length>0?ce:F,pe=G.reduce((v,W)=>v+Number(W.quantity||0),0);console.log("Size Variants:",ue),console.log("Processed Size Variants:",ce),console.log("Final Variants:",G),console.log("Is Combination:",Q),he(!0),h(g.price),ae(g.stock),le(g.barcode),$(g.sku),E(g.originalPrice);const Fe=await ut(g.title,_,Z==null?void 0:Z.title),p=await ut(g.description,_,Z==null?void 0:Z.description),Ee={productId:z,sku:g.sku||"",barcode:g.barcode||"",title:{...Fe,[_]:g.title},description:{...p,[_]:g.description||""},slug:g.slug?g.slug:g.title.toLowerCase().replace(/[^A-Z0-9]+/gi,"-"),categories:Ve.map(v=>v._id),category:Ce[0]._id,image:C,stock:(G==null?void 0:G.length)>0?Number(pe):g.stock,tag:JSON.stringify(K),prices:{price:mt(g.price),originalPrice:Ae(g.originalPrice),discount:Number(g.originalPrice)-Number(g.price)},isCombination:(G==null?void 0:G.length)>0&&Q,variants:Q&&(G==null?void 0:G.length)>0?G:[]};if(console.log("Product Data to be saved:",JSON.stringify(Ee,null,2)),se){const v=await at.updateProduct(se,Ee);v&&(Q?(n(!0),me(v.message),he(!0),Ne(!1),Re("Combination",!0)):(n(!0),me(v.message),Ne(!1))),(oe==="Combination"||oe!=="Combination"&&!Q)&&a()}else{const v=await at.addProduct(Ee);if(Q){ie(v._id),P("title",v.title[_||"en"]),P("description",v.description[_||"en"]),P("slug",v.slug),P("show",v.show),P("barcode",v.barcode),P("stock",v.stock),M(JSON.parse(v.tag)),T(v.image),m(v.variants),P("productId",v.productId),J(v.productId),E((I=v==null?void 0:v.prices)==null?void 0:I.originalPrice),h((V=v==null?void 0:v.prices)==null?void 0:V.price),le(v.barcode),$(v.sku);const W=v.variants.map(({originalPrice:st,price:He,discount:Hs,quantity:Js,barcode:Qs,sku:Ys,productId:Gs,image:Xs,...Qt})=>Qt);y(W),n(!0),he(!0),Ne(!1),Re("Combination",!0),me("Product Added Successfully!")}else n(!0),me("Product Added Successfully!");(oe==="Combination"||oe!=="Combination"&&!Q)&&(Ne(!1),a())}}catch(F){Ne(!1),ee(((U=(q=F==null?void 0:F.response)==null?void 0:q.data)==null?void 0:U.message)||(F==null?void 0:F.message)),a()}};c.useEffect(()=>{var g;if(r)Re("Basic Info",!0);else{tt(""),b(d),P("language",_),Re("Basic Info",!0),L({}),P("sku"),P("title"),P("slug"),P("description"),P("quantity"),P("stock"),P("originalPrice"),P("price"),P("barcode"),P("productId"),J(""),T([]),M([]),m([]),y([]),qe([]),dt(!1),B({}),O(0),ve([]),Se([]),s.pathname==="/products"&&((g=w==null?void 0:w.current)==null||g.resetSelectedValues()),we("sku"),we("title"),we("slug"),we("description"),we("stock"),we("quantity"),P("stock",0),P("costPrice",0),P("price",0),P("originalPrice",0),we("show"),we("barcode"),je(!1),he(!1),Ne(!1),A([]),ie();return}t&&(he(!0),(async()=>{var I,V,q,U,F,ce,G,pe,Fe;try{const p=await at.getProductById(t);if(p){L(p),tt(p.slug),ie(p._id),P("title",p.title[_||"en"]),P("description",p.description[_||"en"]),P("slug",p.slug),P("show",p.show),P("sku",p.sku),P("barcode",p.barcode),P("stock",p.stock),P("productId",p.productId),P("price",(I=p==null?void 0:p.prices)==null?void 0:I.price),P("originalPrice",(V=p==null?void 0:p.prices)==null?void 0:V.originalPrice),P("stock",p.stock),J(p.productId?p.productId:p._id),le(p.barcode),$(p.sku),p.categories.map(W=>(W.name=Pe(W==null?void 0:W.name,d),W)),p.category.name=Pe((q=p==null?void 0:p.category)==null?void 0:q.name,d),ve(p.categories),Se([p==null?void 0:p.category]),M(JSON.parse(p.tag)),T(p.image);const Ee=((U=p.variants)==null?void 0:U.filter(W=>W.variantType==="size"))||[],v=((F=p.variants)==null?void 0:F.filter(W=>W.variantType!=="size"))||[];Ee.length>0?(qe(Ee),m([])):(m(p.variants),qe([])),je(p.isCombination),ae(p==null?void 0:p.stock),O(p.stock),E((ce=p==null?void 0:p.prices)==null?void 0:ce.originalPrice),h((G=p==null?void 0:p.prices)==null?void 0:G.price)}}catch(p){ee(((Fe=(pe=p==null?void 0:p.response)==null?void 0:pe.data)==null?void 0:Fe.message)||(p==null?void 0:p.message))}})())},[t,P,r,s.pathname,we,_,d]),c.useEffect(()=>{const g=l==null?void 0:l.filter(I=>I.option!=="Checkbox").map(I=>({label:Pe(I==null?void 0:I.title,d),value:Pe(I==null?void 0:I.title,d)}));if(f([...g]),(ue==null?void 0:ue.length)>0){const I=l==null?void 0:l.find(V=>Pe(V==null?void 0:V.title,d).toLowerCase()==="size");if(I){Y([I]);const V=ue==null?void 0:ue.reduce((q,U)=>q+U.quantity,0);O(Number(V))}}else{const I=Object==null?void 0:Object.keys(Object.assign({},...i)),V=l==null?void 0:l.filter(q=>I.includes(q._id));if((i==null?void 0:i.length)>0){const q=i==null?void 0:i.reduce((U,F)=>U+F.quantity,0);O(Number(q))}Y(V)}},[l,i,ue,_,d]);const $t=(g,I)=>{const q=l.filter(U=>{const F=Pe(U==null?void 0:U.title,d);return g.some(ce=>ce.label===F)}).map(U=>{const F=Pe(U==null?void 0:U.title,d);return{...U,label:F,value:F}});A(q)},zt=()=>{if(Object.keys(H).length===0)return ee("Please select a variant first!");const g=i.filter(({originalPrice:V,discount:q,price:U,quantity:F,barcode:ce,sku:G,productId:pe,image:Fe,...p})=>JSON.stringify({...p})!=="{}");m(g),Os(H).map((V,q)=>{if(JSON.stringify(o).includes(JSON.stringify(V)))return y(U=>[...U,V]);{const U={...V,originalPrice:Ae(X),price:mt(k),quantity:Number(te),discount:Number(X-k),productId:z&&z+"-"+(i.length+q),barcode:ge,sku:R,image:C[0]||""};return m(F=>[...F,U]),y(F=>[...F,V])}}),B({})},Lt=()=>{var g;m([]),y([]),B({}),(g=j==null?void 0:j.current)==null||g.map(async(I,V)=>{var q;return await((q=j==null?void 0:j.current[V])==null?void 0:q.resetSelectedValues())})},Ut=g=>{de("Combine")},Mt=(g,I)=>{bt({title:`Are you sure to delete this ${I?"Extra":"combination"}!`,text:`(If Okay, It will be delete this ${I?"Extra":"combination"})`,icon:"warning",buttons:!0,dangerMode:!0}).then(V=>{if(V){const q=i.filter(He=>He!==g);m(q);const{originalPrice:U,price:F,discount:ce,quantity:G,barcode:pe,sku:Fe,productId:p,image:Ee,...v}=g,W=o.filter(He=>JSON.stringify(He)!==JSON.stringify(v));y(W),xe(!0);const st=setTimeout(()=>xe(!1),500);return clearTimeout(st)}})},_t=()=>{Q&&(D.length>0||ue.length>0)?bt({title:"Are you sure to remove combination from this product!",text:"(It will be delete all your combination and extras)",icon:"warning",buttons:!0,dangerMode:!0}).then(g=>{g&&(je(!Q),de("Basic Info"),m([]),y([]),qe([]))}):(je(!Q),de("Basic Info"))},Kt=g=>{fe&&(i[Be].image=g,ne(!1))},Ht=g=>{De(g),ne(!fe)},Jt=(g,I,V)=>{i[V][I]=g},Re=(g,I,V)=>{if(I){if(!I)return ee("Please save product before adding combinations!")}else if(!ye)return ee("Please save product before adding combinations!");de(g)};return{tag:K,setTag:M,values:H,language:_,register:Dt,onSubmit:Rt,errors:qt,slug:Ft,openModal:fe,attribue:l,setValues:B,variants:i,setVariants:m,imageUrl:C,setImageUrl:T,handleSubmit:Vt,isCombination:Q,variantTitle:D,attributes:S,attTitle:x,handleAddAtt:$t,productId:z,onCloseModal:Bt,isBulkUpdate:Ke,isSubmitting:It,tapValue:oe,setTapValue:de,resetRefTwo:w,handleSkuBarcode:Jt,handleProductTap:Re,selectedCategory:Ve,setSelectedCategory:ve,setDefaultCategory:Se,defaultCategory:Ce,handleProductSlug:g=>{P("slug",g.toLowerCase().replace(/[^A-Z0-9]+/gi,"-")),tt(g.toLowerCase().replace(/[^A-Z0-9]+/gi,"-"))},handleSelectLanguage:g=>{b(g),Object.keys(Z).length>0&&(P("title",Z.title[g||"en"]),P("description",Z.description[g||"en"]))},handleIsCombination:_t,handleEditVariant:Ut,handleRemoveVariant:Mt,handleClearVariant:Lt,handleQuantityPrice:(g,I,V,q)=>{if(I==="originalPrice"&&Number(g)<Number(q.price)){ee("Price must be more then or equal of originalPrice!"),P("originalPrice",q.originalPrice),xe(!0);const F=setTimeout(()=>xe(!1),100);return()=>clearTimeout(F)}if(I==="price"&&Number(q.originalPrice)<Number(g)){ee("Sale Price must be less then or equal of product price!"),P("price",q.originalPrice),xe(!0);const F=setTimeout(()=>xe(!1),100);return()=>clearTimeout(F)}m(F=>F.map((ce,G)=>{if(G===V){const pe={...ce,[I]:Math.round(g)};return I==="price"&&(pe.price=Ae(g),pe.discount=Number(q.originalPrice)-Number(g)),I==="originalPrice"&&(pe.originalPrice=Ae(g),pe.discount=Number(g)-Number(q.price)),pe}return ce}));const U=i.reduce((F,ce)=>Number(F)+Number(ce.quantity),0);O(Number(U))},handleSelectImage:Kt,handleSelectInlineImage:Ht,handleGenerateCombination:zt,sizeVariants:ue,setSizeVariants:qe,useSizeVariantSystem:Ot,setUseSizeVariantSystem:dt,price:k,originalPrice:X}},vt=({tapValue:t,activeValue:s,handleProductTap:r})=>e.jsx("button",{className:`inline-block px-4 py-2 text-base ${t===s&&"text-blue-700 border-blue-700 dark:text-blue-500 dark:border-blue-500 rounded-t-lg border-b-2 font-semibold"} focus:outline-none transition-all duration-200`,"aria-current":"page",onClick:()=>r(s,!1,t),children:s}),Ds=({imageUrl:t,handleSelectImage:s})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full text-center",children:e.jsx("aside",{className:"flex flex-row flex-wrap mt-4",children:(t==null?void 0:t.length)>=1?t==null?void 0:t.map((r,a)=>e.jsx("div",{className:"relative",children:e.jsx("img",{onClick:()=>s(r),className:"inline-flex border rounded-md border-gray-100 dark:border-gray-600 w-24 max-h-24 p-2 m-2",src:r,alt:"product"})},a+1)):e.jsx("div",{className:"p-8 text-red-500 dark:text-red-400",children:"No Product Image Uploaded Yet!"})})})}),Vs=({attributes:t,values:s,setValues:r,selectedValueClear:a})=>{var te,ae,X,E,k;const[n,d]=c.useState([]),[l,j]=c.useState([]),[w,C]=c.useState(!1),[T,K]=c.useState(""),[M,H]=c.useState("#000000"),{showingTranslateValue:B}=_e(),i={red:"#EF4444",green:"#10B981",blue:"#3B82F6",yellow:"#F59E0B",purple:"#8B5CF6",pink:"#EC4899",orange:"#F97316",cyan:"#06B6D4",black:"#000000",white:"#FFFFFF",gray:"#6B7280",grey:"#6B7280",brown:"#92400E",lime:"#84CC16",indigo:"#6366F1",teal:"#14B8A6",amber:"#F59E0B",emerald:"#10B981",sky:"#0EA5E9",violet:"#7C3AED",fuchsia:"#D946EF",rose:"#F43F5E"},m=h=>{if(!h||typeof h!="string")return null;const R=h.toLowerCase();for(const[$,ge]of Object.entries(i))if(R.includes($))return ge;return null},o=h=>{j(h),r({...s,[t._id]:h==null?void 0:h.map(R=>R._id)})},y=()=>{if(!T.trim()){ee("Please enter a valid option name");return}const h={_id:`temp_${Date.now()}`,name:{en:T.trim()},label:T.trim(),value:`temp_${Date.now()}`};d([...n,h]),j([...l,h]),r({...s,[t._id]:[...s[t._id]||[],h._id]}),me(`Added "${T}" successfully`),K(""),H("#000000"),C(!1)},N=({checked:h,option:R,onClick:$,disabled:ge})=>{const le=m(B(R==null?void 0:R.name));return e.jsxs("div",{className:`item-renderer ${ge?"disabled":""}`,onClick:$,children:[e.jsx("input",{type:"checkbox",onChange:$,checked:h,tabIndex:-1,disabled:ge}),e.jsxs("div",{className:"flex items-center ml-2",children:[le&&e.jsx("span",{className:"inline-block w-4 h-4 rounded-full mr-2 border border-gray-300",style:{backgroundColor:le}}),e.jsx("span",{children:B(R==null?void 0:R.name)})]})]})};c.useEffect(()=>{var R;const h=(R=t==null?void 0:t.variants)==null?void 0:R.map($=>({...$,label:B($==null?void 0:$.name),value:$==null?void 0:$._id}));d(h||[])},[t==null?void 0:t.variants]),c.useEffect(()=>{a&&j([])},[a]);const O=typeof((te=t==null?void 0:t.title)==null?void 0:te.en)=="string"&&((X=(ae=t==null?void 0:t.title)==null?void 0:ae.en)==null?void 0:X.toLowerCase().includes("color"))||typeof(t==null?void 0:t.title)=="string"&&((k=(E=t==null?void 0:t.title)==null?void 0:E.toLowerCase())==null?void 0:k.includes("color"));return e.jsxs("div",{children:[e.jsx(it,{options:n,value:l,onChange:h=>o(h),labelledBy:"Select",ItemRenderer:O?N:void 0}),e.jsx("div",{className:"mt-2",children:w?e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 mt-2 bg-gray-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:T,onChange:h=>K(h.target.value),placeholder:"Enter option name (e.g., Red, Blue)",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-500",onKeyPress:h=>{h.key==="Enter"&&(h.preventDefault(),y())}}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:y,className:"px-3 py-1.5 text-xs bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors",children:"Add"}),e.jsx("button",{type:"button",onClick:()=>{C(!1),K(""),H("#000000")},className:"px-3 py-1.5 text-xs bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})}):e.jsxs("button",{type:"button",onClick:()=>C(!0),className:"flex items-center text-xs text-emerald-600 hover:text-emerald-800 font-medium",children:[e.jsx(et,{className:"mr-1"})," Add New Option"]})})]})},qs=({attributes:t,values:s,setValues:r,selectedValueClear:a})=>{var N,O,te,ae,X;const[n,d]=c.useState([]),[l,j]=c.useState([]),[w,C]=c.useState(!1),[T,K]=c.useState(""),{showingTranslateValue:M}=_e(),H={red:"#EF4444",green:"#10B981",blue:"#3B82F6",yellow:"#F59E0B",purple:"#8B5CF6",pink:"#EC4899",orange:"#F97316",cyan:"#06B6D4",black:"#000000",white:"#FFFFFF",gray:"#6B7280",grey:"#6B7280",brown:"#92400E",lime:"#84CC16",indigo:"#6366F1",teal:"#14B8A6",amber:"#F59E0B",emerald:"#10B981",sky:"#0EA5E9",violet:"#7C3AED",fuchsia:"#D946EF",rose:"#F43F5E"},B=E=>{if(!E||typeof E!="string")return null;const k=E.toLowerCase();for(const[h,R]of Object.entries(H))if(k.includes(h))return R;return null},i=E=>{j(E),r({...s,[t._id]:E==null?void 0:E.map(k=>k._id)})},m=()=>{if(!T.trim()){ee("Please enter a valid option name");return}const E={_id:`temp_${Date.now()}`,name:{en:T.trim()},label:T.trim(),value:`temp_${Date.now()}`};d([...n,E]),j([...l,E]),r({...s,[t._id]:[...s[t._id]||[],E._id]}),me(`Added "${T}" successfully`),K(""),C(!1)},o=({checked:E,option:k,onClick:h,disabled:R})=>{const $=B(M(k==null?void 0:k.name));return e.jsxs("div",{className:`item-renderer ${R?"disabled":""}`,onClick:h,children:[e.jsx("input",{type:"checkbox",onChange:h,checked:E,tabIndex:-1,disabled:R}),e.jsxs("div",{className:"flex items-center ml-2",children:[$&&e.jsx("span",{className:"inline-block w-4 h-4 rounded-full mr-2 border border-gray-300",style:{backgroundColor:$}}),e.jsx("span",{children:M(k==null?void 0:k.name)})]})]})};c.useEffect(()=>{var k;const E=(k=t==null?void 0:t.variants)==null?void 0:k.map(h=>({...h,label:M(h==null?void 0:h.name),value:h==null?void 0:h._id}));d(E||[])},[t==null?void 0:t.variants]),c.useEffect(()=>{a&&j([])},[a]);const y=typeof((N=t==null?void 0:t.title)==null?void 0:N.en)=="string"&&((te=(O=t==null?void 0:t.title)==null?void 0:O.en)==null?void 0:te.toLowerCase().includes("color"))||typeof(t==null?void 0:t.title)=="string"&&((X=(ae=t==null?void 0:t.title)==null?void 0:ae.toLowerCase())==null?void 0:X.includes("color"));return e.jsxs("div",{children:[e.jsx(it,{options:n,value:l,onChange:E=>i(E),labelledBy:"Select",ItemRenderer:y?o:void 0}),e.jsx("div",{className:"mt-2",children:w?e.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-3 mt-2 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:T,onChange:E=>K(E.target.value),placeholder:"Enter option name (e.g., Red, Blue)",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",onKeyPress:E=>{E.key==="Enter"&&(E.preventDefault(),m())}}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:m,className:"px-3 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Add"}),e.jsx("button",{type:"button",onClick:()=>{C(!1),K("")},className:"px-3 py-1.5 text-xs bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-200 rounded hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:"Cancel"})]})]})}):e.jsxs("button",{type:"button",onClick:()=>C(!0),className:"flex items-center text-xs text-blue-600 hover:text-blue-800 font-medium transition-colors",children:[e.jsx(et,{className:"mr-1"})," Add New Option"]})})]})},Rs=({variantId:t,designerImages:s={},onImagesChange:r,designerPrices:a={},onPricesChange:n})=>{const[d,l]=c.useState(null),j={front:(s==null?void 0:s.front)||"",back:(s==null?void 0:s.back)||"",left:(s==null?void 0:s.left)||"",right:(s==null?void 0:s.right)||""},w={front:(a==null?void 0:a.front)||0,back:(a==null?void 0:a.back)||0,left:(a==null?void 0:a.left)||0,right:(a==null?void 0:a.right)||0},[C,T]=c.useState(j),[K,M]=c.useState(w);c.useEffect(()=>{console.log("[DesignerImageUploader] designerImages prop changed:",s);const o={front:(s==null?void 0:s.front)||"",back:(s==null?void 0:s.back)||"",left:(s==null?void 0:s.left)||"",right:(s==null?void 0:s.right)||""};console.log("[DesignerImageUploader] Setting imageUrls to:",o),T(o)},[s]),c.useEffect(()=>{const o={front:(a==null?void 0:a.front)||0,back:(a==null?void 0:a.back)||0,left:(a==null?void 0:a.left)||0,right:(a==null?void 0:a.right)||0};M(o)},[a]);const H=[{key:"front",label:"Front View"},{key:"back",label:"Back View"},{key:"left",label:"Left Side"},{key:"right",label:"Right Side"}],B=(o,y)=>{console.log("[DesignerImageUploader] handleImageUpload called:",{view:o,url:y});const N={...C,[o]:y};console.log("[DesignerImageUploader] updated images:",N),T(N),typeof r=="function"&&r(N),l(null)},i=o=>{const y={...C,[o]:""};T(y),typeof r=="function"&&r(y)},m=(o,y)=>{const N=parseFloat(y)||0,O={...K,[o]:N};M(O),typeof n=="function"&&n(O)};return console.log("[DesignerImageUploader] Render - imageUrls:",C),console.log("[DesignerImageUploader] Render - each view check:",{front:!!C.front,back:!!C.back,left:!!C.left,right:!!C.right}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:H.map(o=>{const y=C&&C[o.key]&&C[o.key].trim()!=="";return console.log(`[DesignerImageUploader] Rendering ${o.key}:`,{hasImage:y,url:C[o.key]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-2",children:o.label}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Extra Price"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:K[o.key]||0,onChange:N=>m(o.key,N.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:border-blue-500 dark:bg-gray-800 dark:text-gray-200",placeholder:"0.00"})]}),y?e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-full h-24 bg-gray-100 rounded border border-gray-300 dark:border-gray-600 overflow-hidden flex items-center justify-center",children:e.jsx("img",{src:C[o.key],alt:o.label,className:"max-w-full max-h-full object-contain",onError:()=>{console.warn(`Designer image failed to load for ${o.key}`,C[o.key]),i(o.key)}})}),e.jsx("button",{onClick:()=>i(o.key),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",type:"button",children:e.jsx(Ue,{size:12})}),e.jsx("button",{onClick:()=>l(o.key),className:"absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center text-white text-xs",type:"button",children:"Change"})]}):e.jsxs("button",{onClick:()=>l(o.key),className:"w-full h-24 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded flex flex-col items-center justify-center text-gray-400 hover:border-blue-500 hover:text-blue-500 transition-colors",type:"button",children:[e.jsx(rs,{className:"mb-1"}),e.jsx("span",{className:"text-xs",children:"Upload"})]}),d===o.key&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Upload ",o.label]}),e.jsx("button",{onClick:()=>l(null),className:"text-gray-500 hover:text-gray-700",type:"button",children:e.jsx(Ue,{size:24})})]}),e.jsx(kt,{folder:"designer-images",imageUrl:C[o.key]||"",setImageUrl:N=>{let O="";if(!N){console.warn("[DesignerImageUploader] Uploader returned empty result for",o.key,N);return}if(Array.isArray(N))O=N[0]||"";else if(typeof N=="string")O=N;else{console.warn("[DesignerImageUploader] Unexpected uploader result shape:",N);return}O&&O.trim().length>0?B(o.key,O.trim()):console.warn("[DesignerImageUploader] Resolved url is empty for",o.key,N)}}),e.jsx("div",{className:"mt-4 flex justify-end gap-2",children:e.jsx(u.Button,{onClick:()=>l(null),layout:"outline",type:"button",children:"Cancel"})})]})})]},o.key)})})},Je=({id:t,value:s,name:r,variant:a,readOnly:n,isBulkUpdate:d,placeholder:l,handleQuantityPrice:j})=>e.jsxs(e.Fragment,{children:[d&&e.jsx(u.Input,{onChange:j,disabled:n,value:s||0,type:"number",name:r,pattern:"^[0-9]+$",placeholder:l,className:"mx-1 h-8 w-18 md:w-20 lg:w-20 p-2"}),!d&&e.jsx(u.Input,{onBlur:w=>j(w.target.value,r,t,a),disabled:n,defaultValue:s,type:"number",name:r,pattern:"^[0-9]+$",placeholder:l,className:"mx-1 h-8 w-18 md:w-20 lg:w-20 p-2"})]}),Qe=({id:t,value:s,name:r,placeholder:a,handleSkuBarcode:n})=>e.jsx(e.Fragment,{children:e.jsx(u.Input,{onBlur:d=>n(d.target.value,r,t),defaultValue:s,type:"text",name:r,placeholder:a,className:"mx-1 h-8 w-18 md:w-20 lg:w-20 p-2"})}),Nt=({extra:t,variant:s,handleRemoveVariant:r,attribute:a})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-end text-right",children:[!a&&e.jsx("div",{className:"p-2 cursor-pointer text-gray-400 hover:text-emerald-600",children:e.jsx(yt,{id:"edit",Icon:as,title:"Edit",bgColor:"#14b8a6"})}),e.jsx("div",{onClick:()=>r(s,t),className:"p-2 cursor-pointer text-gray-400 hover:text-red-600",children:e.jsx(yt,{id:"delete",Icon:Me,title:"Delete",bgColor:"#EF4444"})})]})}),$s=({variants:t,setTapValue:s,variantTitle:r,deleteModalShow:a,isBulkUpdate:n,handleSkuBarcode:d,handleEditVariant:l,handleRemoveVariant:j,handleQuantityPrice:w,handleSelectInlineImage:C,onUpdateSizeVariant:T,onUpdateVariant:K})=>{const{t:M}=ot(),{showingTranslateValue:H}=_e(),[B,i]=c.useState(null),[m,o]=c.useState({}),[y,N]=c.useState(null),[O,te]=c.useState({}),[ae,X]=c.useState({}),[E,k]=c.useState([]),h=["XS","S","M","L","XL","XXL"],R=(x,f,D)=>{i({variantIndex:x,tierIndex:f}),o({...D})},$=()=>{i(null),o({})},ge=(x,f)=>{const D=t[x],Y=[...D.pricingTiers],S=parseFloat(m.discount)||0,A=parseFloat(m.basePrice)||0,z=A-A*S/100;Y[f]={...m,basePrice:A,discount:S,finalPrice:z,quantity:parseInt(m.quantity)||0};const J={...D,pricingTiers:Y};T&&T(x,J),me("Pricing tier updated"),i(null),o({})},le=(x,f)=>{const D=t[x];if(D.pricingTiers.length<=1){ee("At least one pricing tier is required");return}const Y=D.pricingTiers.filter((A,z)=>z!==f),S={...D,pricingTiers:Y};T&&T(x,S),me("Pricing tier deleted")},ye=(x,f)=>{o(D=>({...D,[x]:f}))},he=x=>{const f=t[x],D=f.pricingTiers[f.pricingTiers.length-1],Y=D.quantity+50,S={quantity:Y,basePrice:D.basePrice,discount:0,finalPrice:D.basePrice},A=[...f.pricingTiers,S],z={...f,pricingTiers:A};T&&T(x,z),me(`New tier added: ${Y} pieces`)},oe=x=>{const f=t[x];N(x),te(f.designerImages||{front:"",back:"",left:"",right:""}),X(f.designerPrices||{front:0,back:0,left:0,right:0}),k(f.availableSizes||[])},de=()=>{N(null),te({}),X({}),k([])},Q=x=>{const f=t[x],D={...f,designerImages:O,designerPrices:ae,availableSizes:E};console.log("[AttributeListTable] Saving variant designer changes:",{variantIndex:x,originalVariant:f,updatedVariant:D}),typeof K=="function"?K(x,D):typeof T=="function"&&T(x,D),me("Variant updated successfully"),de()},je=x=>{k(f=>f.includes(x)?f.filter(D=>D!==x):[...f,x])};return e.jsx(e.Fragment,{children:e.jsx(u.TableBody,{children:t==null?void 0:t.map((x,f)=>{var Y;return x.variantType==="size"&&x.pricingTiers?e.jsxs(re.Fragment,{children:[e.jsxs(u.TableRow,{className:"bg-blue-50 dark:bg-blue-900",children:[e.jsx(u.TableCell,{children:e.jsx("div",{className:"flex items-center",children:x.image?e.jsxs("span",{children:[e.jsx(u.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:x.image,alt:"product"}),e.jsx("p",{className:"text-xs cursor-pointer text-blue-600",onClick:()=>C(f),children:M("Change")})]}):e.jsxs("span",{children:[e.jsx(u.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"}),e.jsx("p",{className:"text-xs cursor-pointer text-blue-600",onClick:()=>C(f),children:M("Change")})]})})}),e.jsx(u.TableCell,{children:e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-400",children:x.combination}),e.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:["Size Variant (",x.pricingTiers.length," tiers)"]})]})}),e.jsx(u.TableCell,{children:e.jsx(Qe,{id:f,name:"sku",placeholder:"Sku",value:x.sku,handleSkuBarcode:d})}),e.jsx(u.TableCell,{children:e.jsx(Qe,{id:f,name:"barcode",placeholder:"Barcode",value:x.barcode,handleSkuBarcode:d})}),e.jsx(u.TableCell,{colSpan:2,children:e.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Pricing Tiers Below â†“"})}),e.jsx(u.TableCell,{className:"font-medium text-sm",children:e.jsx(Je,{id:f,name:"quantity",placeholder:"Quantity",variant:x,isBulkUpdate:n,handleQuantityPrice:w,value:x.quantity||0})}),e.jsx(u.TableCell,{children:e.jsx(Nt,{attribute:!0,variant:x,setTapValue:s,deleteModalShow:a,handleEditVariant:l,handleRemoveVariant:j})})]}),x.pricingTiers.map((S,A)=>{const z=(B==null?void 0:B.variantIndex)===f&&(B==null?void 0:B.tierIndex)===A;return e.jsxs(u.TableRow,{className:"bg-white dark:bg-gray-800 border-l-4 border-blue-400",children:[e.jsx(u.TableCell,{colSpan:2}),e.jsx(u.TableCell,{colSpan:2,children:z?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u.Input,{type:"number",value:m.quantity,onChange:J=>ye("quantity",J.target.value),className:"w-24 text-xs",placeholder:"Qty"}),e.jsx("span",{className:"text-xs",children:"pieces"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[S.quantity," pieces"]}),S.discount>0&&e.jsxs("span",{className:"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-2 py-0.5 rounded",children:[S.discount,"% off"]})]})}),e.jsx(u.TableCell,{className:"text-xs",children:z?e.jsx("div",{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs",children:"$"}),e.jsx(u.Input,{type:"number",step:"0.01",value:m.basePrice,onChange:J=>ye("basePrice",J.target.value),className:"w-20 text-xs",placeholder:"Base"})]})}):e.jsxs("span",{children:["Base: $",S.basePrice.toFixed(2)]})}),e.jsx(u.TableCell,{className:"text-xs",children:z?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u.Input,{type:"number",step:"0.1",value:m.discount,onChange:J=>ye("discount",J.target.value),className:"w-16 text-xs",placeholder:"%"}),e.jsx("span",{className:"text-xs",children:"%"})]}),e.jsxs("span",{className:"text-gray-500 text-xs",children:["Final: $",(m.basePrice-m.basePrice*m.discount/100).toFixed(2)]})]}):e.jsxs("div",{children:[e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:["Final: $",S.finalPrice.toFixed(2)]}),e.jsxs("div",{className:"text-gray-500 text-xs",children:["Total: $",(S.finalPrice*S.quantity).toFixed(2)]})]})}),e.jsx(u.TableCell,{colSpan:2,children:z?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ge(f,A),className:"p-1 text-green-600 hover:bg-green-50 dark:hover:bg-green-900 rounded transition-colors",title:"Save",children:e.jsx(xt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:$,className:"p-1 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Cancel",children:e.jsx(Ue,{className:"w-4 h-4"})}),x.pricingTiers.length>1&&e.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete the ${S.quantity} pieces tier?`)&&($(),le(f,A))},className:"p-1 text-red-500 hover:bg-red-50 dark:hover:bg-red-900 rounded transition-colors",title:"Delete Tier",children:e.jsx(Me,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R(f,A,S),className:"p-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900 rounded transition-colors",title:"Edit Tier",children:e.jsx(lt,{className:"w-4 h-4"})}),x.pricingTiers.length>1&&e.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete the ${S.quantity} pieces tier?`)&&le(f,A)},className:"p-1 text-red-500 hover:bg-red-50 dark:hover:bg-red-900 rounded transition-colors",title:"Delete Tier",children:e.jsx(Me,{className:"w-4 h-4"})})]})})]},`${f}-tier-${A}`)}),e.jsx(u.TableRow,{className:"bg-blue-50 dark:bg-blue-900 border-l-4 border-blue-300",children:e.jsx(u.TableCell,{colSpan:8,children:e.jsx("div",{className:"flex justify-center py-2",children:e.jsxs(u.Button,{onClick:()=>he(f),size:"small",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(et,{className:"w-4 h-4"}),e.jsxs("span",{children:["Add New Tier for ",x.combination]})]})})})})]},f+1):e.jsxs(re.Fragment,{children:[e.jsxs(u.TableRow,{children:[e.jsx(u.TableCell,{children:e.jsxs("div",{className:"flex flex-col items-start gap-2",children:[e.jsx("div",{className:"flex items-center",children:x.image?e.jsxs("span",{children:[e.jsx(u.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:x.image,alt:"product"}),e.jsx("p",{className:"text-xs cursor-pointer",onClick:()=>C(f),children:M("Change")})]}):e.jsxs("span",{children:[e.jsx(u.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"}),e.jsx("p",{className:"text-xs cursor-pointer",onClick:()=>C(f),children:M("Change")})]})}),e.jsxs("button",{onClick:()=>oe(f),className:"flex items-center gap-1 px-3 py-1 text-xs font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded transition-colors",children:[e.jsx(lt,{className:"w-3 h-3"}),"Edit Designer"]})]})}),e.jsx(u.TableCell,{children:e.jsxs("div",{className:"flex flex-col text-sm",children:[(r==null?void 0:r.length)>0&&e.jsx("span",{children:(Y=r==null?void 0:r.map(S=>{var J,se;const A=(J=S==null?void 0:S.variants)==null?void 0:J.filter(ie=>(ie==null?void 0:ie.name)!=="All"),z=(se=A==null?void 0:A.find(ie=>ie._id===x[S==null?void 0:S._id]))==null?void 0:se.name;return z===void 0?z==null?void 0:z.en:H(z)}))==null?void 0:Y.filter(Boolean).join(" ")}),x.productId&&e.jsxs("span",{className:"text-xs productId text-gray-500",children:["(",x.productId,")"]})]})}),e.jsx(u.TableCell,{children:e.jsx(Qe,{id:f,name:"sku",placeholder:"Sku",value:x.sku,handleSkuBarcode:d})}),e.jsx(u.TableCell,{children:e.jsx(Qe,{id:f,name:"barcode",placeholder:"Barcode",value:x.barcode,handleSkuBarcode:d})}),e.jsx(u.TableCell,{className:"font-medium text-sm",children:e.jsx(Je,{id:f,name:"originalPrice",placeholder:"Original Price",variant:x,isBulkUpdate:n,value:x.originalPrice||"",handleQuantityPrice:w})}),e.jsx(u.TableCell,{className:"font-medium text-sm",children:e.jsx(Je,{id:f,name:"price",placeholder:"Sale price",variant:x,isBulkUpdate:n,value:x.price||"",handleQuantityPrice:w})}),e.jsx(u.TableCell,{className:"font-medium text-sm",children:e.jsx(Je,{id:f,name:"quantity",placeholder:"Quantity",variant:x,isBulkUpdate:n,handleQuantityPrice:w,value:x.quantity||0})}),e.jsx(u.TableCell,{children:e.jsx(Nt,{attribute:!0,variant:x,setTapValue:s,deleteModalShow:a,handleEditVariant:l,handleRemoveVariant:j})})]}),y===f&&e.jsx(u.TableRow,{className:"bg-gray-50 dark:bg-gray-900",children:e.jsx(u.TableCell,{colSpan:8,children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Designer Settings for ",x.combination]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Q(f),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",children:[e.jsx(xt,{className:"w-4 h-4"}),"Save Changes"]}),e.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 hover:bg-gray-300 rounded transition-colors",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Cancel"]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Upload Designer Mockup Images"}),e.jsx(Rs,{variantId:x._id||`variant-${f}`,designerImages:O,onImagesChange:te,designerPrices:ae,onPricesChange:X})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Available Sizes (Check for In Stock, Uncheck for Out of Stock)"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:h.map(S=>{const A=E.includes(S);return e.jsxs("label",{className:`flex items-center gap-2 px-4 py-2 border-2 rounded cursor-pointer transition-all ${A?"border-green-500 bg-green-50 dark:bg-green-900":"border-gray-300 bg-white dark:bg-gray-800"}`,children:[e.jsx("input",{type:"checkbox",checked:A,onChange:()=>je(S),className:"w-4 h-4 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:`text-sm font-medium ${A?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400"}`,children:S}),A&&e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"(In Stock)"}),!A&&e.jsx("span",{className:"text-xs text-red-600 dark:text-red-400",children:"(Out of Stock)"})]},S)})})]})]})})})]},f+1)})})})},zs=({title:t,product:s,handleProcess:r,processOption:a})=>{const{t:n}=ot();return e.jsx(e.Fragment,{children:e.jsx("div",{className:`${s?"mb-3 flex flex-wrap justify-end items-center mr-8":"mb-3"}`,style:{height:s?20:0,transition:"all 0.3s",visibility:s?"visible":"hidden",opacity:s?"1":"0"},children:e.jsxs("div",{className:"flex flex-wrap items-center",children:[s?e.jsx("label",{className:"block text-base font-normal text-blue-500 dark:text-blue-400 mx-4",children:n("ThisProductHaveVariants")}):e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:t}),e.jsx(ds,{onChange:r,checked:a,className:"react-switch md:ml-0 ml-3",uncheckedIcon:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:14,color:"white",paddingRight:5,paddingTop:1},children:"No"}),width:80,height:30,handleDiameter:28,offColor:"#E53E3E",onColor:"#2F855A",checkedIcon:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:14,color:"white",paddingLeft:8,paddingTop:1},children:"Yes"})})]})})})},Ls=({variants:t=[],onVariantsChange:s,currency:r="$",defaultPrice:a=0})=>{const[n,d]=c.useState(null),[l,j]=c.useState({width:"",height:"",unit:"inch",image:"",sku:"",barcode:"",quantity:"",pricingTiers:[{quantity:50,basePrice:a,discount:0,finalPrice:a}]});c.useEffect(()=>{a>0&&!n&&j(i=>({...i,pricingTiers:i.pricingTiers.map(m=>({...m,basePrice:m.basePrice===0?a:m.basePrice,finalPrice:m.basePrice===0?a:m.finalPrice}))}))},[a,n]);const w=()=>{if(!l.width||!l.height){ee("Please enter both width and height");return}if(l.pricingTiers[0].basePrice<=0){ee("Please enter a valid base price");return}const i=`${l.width}" x ${l.height}" (${l.unit})`,m=l.pricingTiers.map(y=>({quantity:parseFloat(y.quantity)||0,basePrice:parseFloat(y.basePrice)||0,discount:parseFloat(y.discount)||0,finalPrice:parseFloat(y.finalPrice)||0})),o={...l,quantity:parseInt(l.quantity)||0,pricingTiers:m,combination:i,id:Date.now()};if(n!==null){const y=[...t];y[n]=o,s(y),me("Size variant updated"),d(null)}else s([...t,o]),me("Size variant added");j({width:"",height:"",unit:"inch",image:"",sku:"",barcode:"",quantity:"",pricingTiers:[{quantity:50,basePrice:a||0,discount:0,finalPrice:a||0}]})},C=i=>{j(t[i]),d(i)},T=i=>{const m=t.filter((o,y)=>y!==i);s(m),me("Size variant deleted")},K=()=>{const i=l.pricingTiers[l.pricingTiers.length-1],m=i.quantity+50,o=i.basePrice||a||0;j({...l,pricingTiers:[...l.pricingTiers,{quantity:m,basePrice:o,discount:0,finalPrice:o}]})},M=i=>{if(l.pricingTiers.length<=1){ee("At least one pricing tier is required");return}const m=l.pricingTiers.filter((o,y)=>y!==i);j({...l,pricingTiers:m})},H=(i,m,o)=>{const y=[...l.pricingTiers];if(o===""||o===null||o===void 0?y[i][m]="":y[i][m]=o,m==="discount"||m==="basePrice"){const N=parseFloat(m==="basePrice"?o:y[i].basePrice)||0,O=parseFloat(m==="discount"?o:y[i].discount)||0;y[i].finalPrice=N-N*O/100}j({...l,pricingTiers:y})},B=i=>(i.finalPrice*i.quantity).toFixed(2);return e.jsxs("div",{className:"space-y-6 pb-32",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200 mb-4",children:n!==null?"Edit Size Variant":"Add New Size Variant"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"Width"}),e.jsx(u.Input,{type:"number",step:"0.1",value:l.width,onChange:i=>j({...l,width:i.target.value}),placeholder:"e.g., 7.5",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"Height"}),e.jsx(u.Input,{type:"number",step:"0.1",value:l.height,onChange:i=>j({...l,height:i.target.value}),placeholder:"e.g., 3.75",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"Unit"}),e.jsxs("select",{value:l.unit,onChange:i=>j({...l,unit:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"inch",children:"Inch"}),e.jsx("option",{value:"cm",children:"CM"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"SKU"}),e.jsx(u.Input,{type:"text",value:l.sku,onChange:i=>j({...l,sku:i.target.value}),placeholder:"Product SKU",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-2",children:"Barcode"}),e.jsx(u.Input,{type:"text",value:l.barcode,onChange:i=>j({...l,barcode:i.target.value}),placeholder:"Product Barcode",className:"w-full"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-700 dark:text-gray-200",children:"Quantity Pricing Tiers"}),e.jsxs(u.Button,{onClick:K,size:"small",className:"flex items-center bg-blue-500 hover:bg-blue-600",children:[e.jsx(et,{className:"mr-1"})," Add Tier"]})]}),e.jsx("div",{className:"space-y-3",children:l.pricingTiers.map((i,m)=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Quantity"}),e.jsx(u.Input,{type:"number",value:i.quantity,onChange:o=>H(m,"quantity",o.target.value),className:"w-full",placeholder:"50"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:["Base Price (",r,")"]}),e.jsx(u.Input,{type:"number",step:"0.01",value:i.basePrice,onChange:o=>H(m,"basePrice",o.target.value),className:"w-full",placeholder:"2.80"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Discount (%)"}),e.jsx(u.Input,{type:"number",step:"0.1",value:i.discount===""?"":i.discount,onChange:o=>H(m,"discount",o.target.value),className:"w-full",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:["Final Price (",r,")"]}),e.jsx(u.Input,{type:"number",step:"0.01",value:i.finalPrice.toFixed(2),disabled:!0,className:"w-full bg-gray-100 dark:bg-gray-800"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Total"}),e.jsxs("div",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[r," ",B(i)]})]}),l.pricingTiers.length>1&&e.jsx("button",{onClick:()=>M(m),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900 rounded transition-colors",children:e.jsx(Me,{className:"w-4 h-4"})})]})]})},m))})]}),e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsx(u.Button,{onClick:w,className:"bg-blue-500 hover:bg-blue-600 text-white",children:n!==null?"Update Size":"Add Size"}),n!==null&&e.jsx(u.Button,{onClick:()=>{d(null),j({width:"",height:"",unit:"inch",image:"",sku:"",barcode:"",quantity:"",pricingTiers:[{quantity:50,basePrice:a||0,discount:0,finalPrice:a||0}]})},layout:"outline",children:"Cancel Edit"})]})]}),t.length>0&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-700 dark:text-slate-200 mb-4",children:["Size Variants (",t.length,")"]}),e.jsx("div",{className:"space-y-4",children:t.map((i,m)=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200",children:i.combination}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["SKU: ",i.sku||"N/A"," | Barcode:"," ",i.barcode||"N/A"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>C(m),className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900 rounded transition-colors",children:e.jsx(lt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(m),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900 rounded transition-colors",children:e.jsx(Me,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded p-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pricing Tiers:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:i.pricingTiers.map((o,y)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-2 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[o.quantity," pieces"]}),e.jsxs("div",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[r," ",o.finalPrice.toFixed(2)," each"]}),o.discount>0&&e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[o.discount,"% off"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Total: ",r," ",B(o)]})]},y))})]})]},i.id||m))})]})]})},Us=({id:t})=>{const{t:s}=ot(),{tag:r,setTag:a,values:n,language:d,register:l,onSubmit:j,errors:w,slug:C,openModal:T,attribue:K,setValues:M,variants:H,imageUrl:B,setImageUrl:i,handleSubmit:m,isCombination:o,variantTitle:y,attributes:N,attTitle:O,handleAddAtt:te,onCloseModal:ae,isBulkUpdate:X,globalSetting:E,isSubmitting:k,tapValue:h,setTapValue:R,resetRefTwo:$,handleSkuBarcode:ge,handleProductTap:le,selectedCategory:ye,setSelectedCategory:he,setDefaultCategory:oe,defaultCategory:de,handleProductSlug:Q,handleSelectLanguage:je,handleIsCombination:x,handleEditVariant:f,handleRemoveVariant:D,handleClearVariant:Y,handleQuantityPrice:S,handleSelectImage:A,handleSelectInlineImage:z,handleGenerateCombination:J,sizeVariants:se,setSizeVariants:ie,setVariants:Be,useSizeVariantSystem:De,setUseSizeVariantSystem:Ke,price:xe,originalPrice:Ve}=Bs(t),{currency:ve,showingTranslateValue:Ce}=_e(),Se=(L,_)=>{const b=[...se];b[L]=_,ie(b)},Z=(L,_)=>{if(console.log("[ProductDrawer] handleUpdateVariant called:",{variantIndex:L,updatedVariant:_,hasSizeVariants:se.length>0}),se.length>0)Se(L,_);else{const b=[...H];b[L]=_,console.log("[ProductDrawer] Updating traditional variants:",{before:H,after:b}),Be(b)}};return e.jsxs(e.Fragment,{children:[e.jsx(Is,{open:T,onClose:ae,center:!0,closeIcon:e.jsx("div",{className:"absolute top-0 right-0 text-red-500  active:outline-none text-xl border-0",children:e.jsx(Ue,{className:"text-3xl"})}),children:e.jsx("div",{className:"cursor-pointer",children:e.jsx(Ds,{imageUrl:B,setImageUrl:i,handleSelectImage:A})})}),e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:t?e.jsx(pt,{register:l,title:s("UpdateProduct"),description:s("UpdateProductDescription")}):e.jsx(pt,{register:l,title:s("DrawerAddProduct"),description:s("AddProductDescription")})}),e.jsxs("div",{className:"text-sm font-medium text-center text-gray-500 border-b border-gray-200 dark:text-gray-400 dark:border-gray-600 dark:bg-gray-700",children:[e.jsx(zs,{product:!0,handleProcess:x,processOption:o}),e.jsxs("ul",{className:"flex flex-wrap -mb-px",children:[e.jsx("li",{className:"mr-2",children:e.jsx(vt,{tapValue:h,activeValue:"Basic Info",handleProductTap:le})}),o&&e.jsx("li",{className:"mr-2",children:e.jsx(vt,{tapValue:h,activeValue:"Combination",handleProductTap:le})})]})]}),e.jsxs(ls.Scrollbars,{className:"track-horizontal thumb-horizontal w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:[e.jsxs("form",{onSubmit:m(j),className:"block",id:"block",children:[h==="Basic Info"&&e.jsxs("div",{className:"px-6 pt-8 flex-grow w-full h-full max-h-full pb-40 md:pb-32 lg:pb-32 xl:pb-32",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductTitleName")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(u.Input,{...l("title",{required:"TItle is required!"}),name:"title",type:"text",placeholder:s("ProductTitleName"),onBlur:L=>Q(L.target.value)}),e.jsx(Ie,{errorName:w.title})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductDescription")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(u.Textarea,{className:"border text-sm  block w-full bg-gray-100 border-gray-200",...l("description",{required:!1}),name:"description",placeholder:s("ProductDescription"),rows:"4",spellCheck:"false"}),e.jsx(Ie,{errorName:w.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductImage")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(kt,{product:!0,folder:"product",imageUrl:B,setImageUrl:i})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductSKU")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ht,{register:l,label:s("ProductSKU"),name:"sku",type:"text",placeholder:s("ProductSKU")}),e.jsx(Ie,{errorName:w.sku})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductBarcode")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ht,{register:l,label:s("ProductBarcode"),name:"barcode",type:"text",placeholder:s("ProductBarcode")}),e.jsx(Ie,{errorName:w.barcode})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("Category")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(es,{lang:d,selectedCategory:ye,setSelectedCategory:he,setDefaultCategory:oe})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("DefaultCategory")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(ts,{displayValue:"name",isObject:!0,singleSelect:!0,ref:$,hidePlaceholder:!0,onKeyPressFn:function(){},onRemove:function(){},onSearch:function(){},onSelect:L=>oe(L),selectedValues:de,options:ye,placeholder:"Default Category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:"Product Price"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ft,{disabled:o,register:l,maxValue:2e3,minValue:1,label:"Original Price",name:"originalPrice",type:"number",placeholder:"OriginalPrice",defaultValue:0,required:!0,product:!0,currency:ve}),e.jsx(Ie,{errorName:w.originalPrice})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("SalePrice")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ft,{disabled:o,product:!0,register:l,minValue:0,defaultValue:0,required:!0,label:"Sale price",name:"price",type:"number",placeholder:"Sale price",currency:ve}),e.jsx(Ie,{errorName:w.price})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductSlug")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(u.Input,{...l("slug",{required:"slug is required!"}),className:" mr-2 p-2",name:"slug",type:"text",defaultValue:C,placeholder:s("ProductSlug"),onBlur:L=>Q(L.target.value)}),e.jsx(Ie,{errorName:w.slug})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(be,{label:s("ProductTag")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(ss,{placeholder:s("ProductTagPlaseholder"),tags:r,onChange:L=>a(L)})})]})]}),h==="Combination"&&o&&(K.length<1?e.jsx("div",{className:"bg-teal-100 border border-teal-600 rounded-md text-teal-900 px-4 py-3 m-4",role:"alert",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"py-1",children:e.jsx("svg",{className:"fill-current h-6 w-6 text-teal-500 mr-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})})}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm",children:[s("AddCombinationsDiscription")," ",e.jsx(Wt,{to:"/attributes",className:"font-bold",children:s("AttributesFeatures")}),s("AddCombinationsDiscriptionTwo")]})})]})}):e.jsx("div",{className:"p-6",children:(()=>{const L=N==null?void 0:N.some(b=>{var ne;return(typeof(b==null?void 0:b.title)=="string"?b.title:((ne=b==null?void 0:b.title)==null?void 0:ne.en)||"").toLowerCase().includes("size")}),_=N==null?void 0:N.some(b=>{var ne;return(typeof(b==null?void 0:b.title)=="string"?b.title:((ne=b==null?void 0:b.title)==null?void 0:ne.en)||"").toLowerCase().includes("color")});return L?e.jsxs("div",{children:[_&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"mb-4 font-semibold text-lg text-gray-700 dark:text-gray-200",children:"Select Colors"}),e.jsx("div",{className:"grid md:grid-cols-2 sm:grid-cols-1 gap-4",children:N==null?void 0:N.filter(b=>{var ne;return(typeof(b==null?void 0:b.title)=="string"?b.title:((ne=b==null?void 0:b.title)==null?void 0:ne.en)||"").toLowerCase().includes("color")}).map((b,fe)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex w-full h-10 justify-between font-sans rounded-tl rounded-tr bg-blue-100 dark:bg-blue-900 px-4 py-3 text-left text-sm font-normal text-gray-700 dark:text-gray-200",children:["Select ",Ce(b==null?void 0:b.title)]}),e.jsx(qs,{id:fe+1,values:n,lang:d,attributes:b,setValues:M})]},b._id))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"mb-4 font-semibold text-lg text-gray-700 dark:text-gray-200",children:"Manage Size Variants"}),e.jsx(Ls,{variants:se,onVariantsChange:ie,currency:ve,defaultPrice:xe})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-4 sm:grid-cols-2 grid-cols-1 gap-3 md:gap-3 xl:gap-3 lg:gap-2 mb-3",children:[e.jsx(it,{options:O==null?void 0:O.filter(b=>{var ne;return!(typeof(b==null?void 0:b.label)=="string"?b.label:((ne=b==null?void 0:b.label)==null?void 0:ne.en)||"").toLowerCase().includes("size")}),value:N,onChange:b=>te(b),labelledBy:"Select"}),N==null?void 0:N.map((b,fe)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex w-full h-10 justify-between font-sans rounded-tl rounded-tr bg-gray-200 px-4 py-3 text-left text-sm font-normal text-gray-700 hover:bg-gray-200",children:["Select",Ce(b==null?void 0:b.title)]}),e.jsx(Vs,{id:fe+1,values:n,lang:d,attributes:b,setValues:M})]},b._id))]}),e.jsxs("div",{className:"flex justify-end mb-6",children:[(N==null?void 0:N.length)>0&&e.jsx(u.Button,{onClick:J,type:"button",className:"mx-2",children:e.jsx("span",{className:"text-xs",children:s("GenerateVariants")})}),y.length>0&&e.jsx(u.Button,{onClick:Y,className:"mx-2",children:e.jsx("span",{className:"text-xs",children:s("ClearVariants")})})]})]})})()})),o?e.jsx(rt,{id:t,save:!0,title:"Product",isSubmitting:k,handleProductTap:le}):e.jsx(rt,{id:t,title:"Product",isSubmitting:k}),h==="Combination"&&e.jsx(rt,{id:t,title:"Product",isSubmitting:k})]}),h==="Combination"&&o&&(y.length>0||se.length>0)&&e.jsx("div",{className:"px-6 overflow-x-auto",children:o&&e.jsx(u.TableContainer,{className:"md:mb-32 mb-40 rounded-b-lg",children:e.jsxs(u.Table,{children:[e.jsx(u.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(u.TableCell,{children:s("Image")}),e.jsx(u.TableCell,{children:s("Combination")}),e.jsx(u.TableCell,{children:s("Sku")}),e.jsx(u.TableCell,{children:s("Barcode")}),e.jsx(u.TableCell,{colSpan:2,children:s("Pricing")}),e.jsx(u.TableCell,{children:s("QuantityTbl")}),e.jsx(u.TableCell,{className:"text-right",children:s("Action")})]})}),e.jsx($s,{lang:d,variants:se.length>0?se:H,setTapValue:R,variantTitle:y,isBulkUpdate:X,handleSkuBarcode:ge,handleEditVariant:f,handleRemoveVariant:D,handleQuantityPrice:S,handleSelectInlineImage:z,onUpdateSizeVariant:Se,onUpdateVariant:Z})]})})})]})]})},pr=re.memo(Us);export{pr as P,Bs as u};
